<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>登录</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta content="telephone=no,email=no" name="format-detection">
    <script src="/js/third-party/flexible.js"></script>
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/pages/login_register/login.css">
    <meta name="data-alcode" content="a2">
</head>

<body data-alcode="277">
<section class="al-mainInner" style="padding-bottom:0;">
    <section class="alLogin">
        <section class="alLoginWidth">
            <article class="alTry"><a href="javascript:;" class="ev_digHole">继续体验</a></article>
            <figure class="alLoginLogo"><img src="/images/img50/new-login/logo.png" /> </figure>
            <div class="loginRegistText" data-alcode-mod="579">
                <ul>
                    <li class="active">登录</li>
                    <li><a href="register.html">注册</a></li>
                </ul>
            </div>
            <!--输入时添加类名 focus-->
            <form id="allinLoginForm">
                <section class="alLogininput userInput">
                    <i class="user"></i>
                    <i class="close" style="display: none"></i>
                    <input type="text" name="email" placeholder="请输入唯医帐号"/>
                    <!--通行证-->
                </section>
                <section class="alLogininput loginTip passportTip">
                </section>
                <section class="alLogininput passwordInput">
                    <i class="password"></i>
                    <i class="close" style="display: none"></i>
                    <i class="eye eyeClose ev_toggleEye"></i>
                    <input type="password" name="password" placeholder="请输入密码" />
                </section>
                <section class="alLogininput loginTip passwordTip">
                </section>
                <input class="alLoginBtn disabled" value='立即进入' type='submit' style="border:none;"/>
            </form>
            <!--<section class="whyAlPass">什么是<a href="allin_pass.html">唯医通行证</a></section>-->

            <section class="alLoginNone">无法登录？</section>
            <!--<section class="thirdParty">-->
            <!--<aside><span>第三方登录</span></aside>-->
            <!--</section>-->
            <!--<section class="caosLogin" data-alcode-mod="581">-->
            <!--<i></i>-->
            <!--<a href="login_caosNew.html">CAOS会员登录</a>-->
            <!--</section>-->
        </section>
    </section>
    <section class="al-bottomSelectorListMask" id=""> <!--on-->
        <section class="al-bottomSelectorListBox">
            <section class="al-bottomSelectorList" data-alcode-mod="582">
                <figure class="al-bottomSelectorItem"><a href="/pages/passport/reset/reset_step1.html" >找回密码</a></figure>
                <figure class="al-bottomSelectorItem"><a href="quickLogin.html">手机验证码快捷登录</a></figure>
            </section>
            <section class="al-bottomSelectorList mgt" style="margin-bottom:0.27rem;background:transparent;">
                <figure class="al-bottomSelectorItem cancel" id="ev-retrieveCancel"><a href="javascript:void(0)" style="background:#858C96;color:#fff;width:94%;margin:0 auto;border-radius:5px;">取消</a></figure>
            </section>
        </section>
    </section>
</section>

<script src="/js/lib/jquery/jquery-2.1.0.min.js"></script>
<script src="/js/lib/jquery/jquery.json-2.4.js"></script>
<script src="/js/third-party/fastclick.js"></script>
<script src="/js/third-party/jquery-validate/jquery.validate.js"></script>
<script src="/js/third-party/jquery-validate/jquery.validate.rules.collection.js"></script>
<script src="/js/comm/main.js"></script>
<script src="/js/comm/common.js"></script>
<script src="/js/comm/comm.func.js"></script>
<script src="/js/comm/comm-customer.js"></script>
<script src="/js/comm/comm-data.js"></script>
<script src="/js/comm/comm_service.js"></script>
<script src="/js/comm/log.js"></script>
<script src="/js/modules/module.user.js"></script>
<!--<script src="/js/passport/loginNew.js"></script>-->
<script>
    $(document).ready(function(){
        console.log('初始化调用');
        var loginDemoTest = {
            checkInvalid:function(val) {
                if (((typeof val == 'string') && (val.length == 0)) || (val == undefined) || (val == 'undefined') || (val == 'null') || (typeof val == 'undefined') || (typeof val == 'null') || (val == null)) {
                    return true;
                } else {
                    return false;
                }
            },
            getQueryString:function(name) {
                    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
                    var r = window.location.search.substr(1).match(reg);
                    if (r != null) return unescape(r[2]);
                    return null;
            },
        loginInit:function(){
                var  webdomain = '//' + location.host;
                var appId = 'wx8d4a2df6fdc13658';
                var searchParam = '';
                var searchUrlOnOff = loginDemoTest.checkInvalid(location.search);
                alert("query参数++++: "+location.search+" :+++++++");
                var loginOnOff = false;
                if(searchUrlOnOff){
                    loginOnOff = true;
                    searchParam =  "?redirectNum=1";
                }else{
                    var redirectNum = loginDemoTest.getQueryString('redirectNum');
                    var loginNumRight = !loginDemoTest.checkInvalid(redirectNum);
                    alert('获取到redirectNum'+redirectNum);
                    if(loginNumRight&&parseInt(redirectNum,10)===1){
                        loginOnOff = false;
                    }else{
                        alert('未获取到redirectNum');
                        searchParam =  location.search+"&redirectNum=1";
                        loginOnOff = true;
                    }
                }
                var href = location.origin+location.pathname+searchParam;
                var toUrl = 'http:' + webdomain + '/mcall/wx/allin/interact/viewVideo/?url=' + encodeURIComponent(href);
                if(loginOnOff){
                    var weixinLoginUrl = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=' + appId + '&redirect_uri=' + encodeURIComponent(toUrl) + '&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect';
                    console.log('执行');
                    alert("未检索到重定向值+++++"+redirectNum+"+++即将跳转");
                    alert('跳转链接'+weixinLoginUrl);
                    window.location.href = weixinLoginUrl;
                }else{
                    alert("检索到重定向值+++++"+redirectNum+"+++不再跳转");
                }
            var getRenzhenStatus = user.getRenZhengStatus();
            alert("获取登陆信息"+getRenzhenStatus);

            }
        };
        loginDemoTest.loginInit();
    });
</script>
</body>

</html>
