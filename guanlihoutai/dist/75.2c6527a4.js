(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{635:function(e,t,a){var n=a(864);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};a(156)(n,o);n.locals&&(e.exports=n.locals)},863:function(e,t,a){"use strict";var n=a(635);a.n(n).a},864:function(e,t,a){(e.exports=a(155)(!1)).push([e.i,"\n.codeBatch-main-contains {\n  width: 1200px;\n  margin: 20px auto;\n}\n.codeBatch-main-contains .code-title {\n    font-family: PingFangSC-Semibold;\n    font-size: 20px;\n    color: #222222;\n    letter-spacing: 0;\n    line-height: 20px;\n    margin: 32px 0 25px;\n}\n.codeBatch-main-contains .search-form {\n    background: #fff;\n    padding-top: 15px;\n    margin-bottom: 30px;\n}\n.codeBatch-main-contains .search-form .from-row {\n      padding-left: 40px;\n}\n.codeBatch-main-contains .search-form .el-input-width {\n      width: auto;\n}\n.codeBatch-main-contains .search-form .el-input .el-input__inner {\n      background: #F7F9FC;\n      border: 1px solid #E6E6E8;\n      border-radius: 4px;\n}\n.codeBatch-main-contains .search-form .submitBtn-container {\n      margin-right: 20px;\n      float: right;\n}\n.codeBatch-main-contains .search-form .el-form-label .el-form-item__label {\n      margin-right: 20px;\n}\n.codeBatch-main-contains .search-form .submitBtn button:nth-of-type(1) {\n      border: none;\n}\n.codeBatch-main-contains .search-form .submitBtn button:nth-of-type(2) {\n      color: #4B67D6;\n      border: 1px solid #4B67D6;\n      border-radius: 4px;\n}\n.codeBatch-main-contains .code-button {\n    margin: 30px 0 30px;\n}\n.codeBatch-main-contains .code-button .creat-button {\n      color: #4B67D6;\n      border: 1px solid #4B67D6;\n      border-radius: 3px;\n}\n.codeBatch-main-contains .viewBotton {\n    border: 1px solid #4B67D6;\n    border-radius: 3px;\n    color: #4B67D6;\n}\n.codeBatch-main-contains .viewBottonOut {\n    display: inline-block;\n    line-height: 1;\n    white-space: nowrap;\n    cursor: pointer;\n    background: #fff;\n    -webkit-appearance: none;\n    text-align: center;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    outline: 0;\n    margin: 0;\n    -webkit-transition: .1s;\n    transition: .1s;\n    font-weight: 500;\n    padding: 12px 20px;\n    font-size: 14px;\n    border: 1px solid #4B67D6;\n    border-radius: 3px;\n    color: #4B67D6;\n    margin-left: 10px;\n}\n",""])},974:function(e,t,a){"use strict";a.r(t);var n=function(){var a=this,e=a.$createElement,n=a._self._c||e;return n("section",{staticClass:"codeBatch-main-contains"},[n("h1",{staticClass:"code-title"},[a._v("兑换码批次列表")]),a._v(" "),n("section",{staticClass:"search-form"},[n("el-form",{ref:"codeBatchForm",attrs:{model:a.searchForm}},[n("el-row",{staticClass:"from-row"},[n("el-col",{attrs:{span:10}},[n("el-form-item",{staticClass:"el-form-label",attrs:{label:"创建时间"}},[n("el-date-picker",{attrs:{type:"daterange",align:"right","start-placeholder":"不限","end-placeholder":"不限","range-separator":"到","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:a.createTime,callback:function(e){a.createTime=e},expression:"createTime"}})],1)],1),a._v(" "),n("el-col",{attrs:{span:7}},[n("el-form-item",{staticClass:"el-form-label",attrs:{label:"兑换码信息",prop:"redeemCode"}},[n("el-input",{staticClass:"el-input-width",attrs:{placeholder:"兑换码名称/批次号"},model:{value:a.searchForm.redeemCode,callback:function(e){a.$set(a.searchForm,"redeemCode",e)},expression:"searchForm.redeemCode"}})],1)],1),a._v(" "),n("el-col",{attrs:{span:7}},[n("el-form-item",{staticClass:"el-form-label",attrs:{label:"批次状态",prop:"batchState"}},[n("el-select",{attrs:{placeholder:"正常"},model:{value:a.searchForm.batchState,callback:function(e){a.$set(a.searchForm,"batchState",e)},expression:"searchForm.batchState"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),n("el-option",{attrs:{label:"正常",value:"0"}}),a._v(" "),n("el-option",{attrs:{label:"已冻结",value:"1"}}),a._v(" "),n("el-option",{attrs:{label:"已过期",value:"2"}})],1)],1)],1)],1),a._v(" "),n("el-row",{staticClass:"from-row"},[n("el-col",{attrs:{span:7}},[n("el-form-item",{staticClass:"el-form-label",attrs:{label:"发行类型",prop:"publishType"}},[n("el-select",{attrs:{placeholder:"全部"},model:{value:a.searchForm.publishType,callback:function(e){a.$set(a.searchForm,"publishType",e)},expression:"searchForm.publishType"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),n("el-option",{attrs:{label:"电子码",value:"0"}}),a._v(" "),n("el-option",{attrs:{label:"纸质码",value:"1"}})],1)],1)],1),a._v(" "),n("el-col",{attrs:{span:7}},[n("el-form-item",{staticClass:"el-form-label",attrs:{label:"申请部门",prop:"applyDepartment"}},[n("el-select",{attrs:{placeholder:"全部"},model:{value:a.searchForm.applyDepartment,callback:function(e){a.$set(a.searchForm,"applyDepartment",e)},expression:"searchForm.applyDepartment"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),n("el-option",{attrs:{label:"市场运营部",value:"0"}}),a._v(" "),n("el-option",{attrs:{label:"商务部",value:"1"}}),a._v(" "),n("el-option",{attrs:{label:"协会事业部",value:"2"}}),a._v(" "),n("el-option",{attrs:{label:"测试部",value:"3"}}),a._v(" "),n("el-option",{attrs:{label:"产品部",value:"4"}})],1)],1)],1),a._v(" "),n("el-col",{attrs:{span:7}},[n("el-form-item",{staticClass:"el-form-label",attrs:{label:"申请用途",prop:"applyPurpose"}},[n("el-select",{attrs:{placeholder:"全部"},model:{value:a.searchForm.applyPurpose,callback:function(e){a.$set(a.searchForm,"applyPurpose",e)},expression:"searchForm.applyPurpose"}},[n("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),n("el-option",{attrs:{label:"厂商购买",value:"0"}}),a._v(" "),n("el-option",{attrs:{label:"院方采购",value:"1"}}),a._v(" "),n("el-option",{attrs:{label:"平台赠送",value:"3"}}),a._v(" "),n("el-option",{attrs:{label:"内部测试",value:"2"}})],1)],1)],1)],1),a._v(" "),n("el-row",[n("el-col",{staticClass:"submitBtn-container",attrs:{span:4}},[n("el-form-item",{staticClass:"submitBtn"},[n("el-button",{on:{click:a.resetForm}},[a._v("清空条件")]),a._v(" "),n("el-button",{on:{click:a.onSubmit}},[a._v("  筛选  ")])],1)],1)],1)],1)],1),a._v(" "),n("section",{staticClass:"code-button"},[n("el-row",[n("el-col",[n("el-button",{staticClass:"el-icon-circle-plus creat-button",on:{click:a.createCodeBtn}},[a._v(" 创建兑换码")])],1)],1)],1),a._v(" "),n("section",{staticClass:"source-list"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:a.tableData}},[n("el-table-column",{attrs:{prop:"id",label:"序号"}}),a._v(" "),n("el-table-column",{attrs:{prop:"redeemCodeName",label:"兑换码名称",width:"300"}}),a._v(" "),n("el-table-column",{attrs:{prop:"redeemCodeBatchCode",label:"批次号",width:"130"}}),a._v(" "),n("el-table-column",{attrs:{prop:"productPrice",label:"面额"}}),a._v(" "),n("el-table-column",{attrs:{prop:"productName",label:"兑换商品",width:"300"}}),a._v(" "),n("el-table-column",{attrs:{prop:"publishCount",label:"发行量"}}),a._v(" "),n("el-table-column",{attrs:{prop:"total",label:"总额",width:"130"}}),a._v(" "),n("el-table-column",{attrs:{label:"有效期",width:"200",formatter:a.fromTime}}),a._v(" "),n("el-table-column",{attrs:{label:"发行类型",formatter:a.fromPublishType}}),a._v(" "),n("el-table-column",{attrs:{label:"批次状态",formatter:a.fromBatchState}}),a._v(" "),n("el-table-column",{attrs:{label:"申请部门",width:"90",formatter:a.fromApplyDepartment}}),a._v(" "),n("el-table-column",{attrs:{prop:"applyPurpose",label:"申请用途",formatter:a.fromApplyPurpose}}),a._v(" "),n("el-table-column",{attrs:{prop:"opUser",label:"创建人",width:"100"}}),a._v(" "),n("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180"}}),a._v(" "),n("el-table-column",{attrs:{fixed:"right",width:"430",label:"操作",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[n("el-button",{staticClass:"viewBotton",on:{click:function(e){a.handleEvent(t.row,1)}}},[a._v("\n                查看\n              ")]),a._v(" "),0===t.row.batchState?n("el-button",{staticClass:"viewBotton",on:{click:function(e){a.handleEvent(t.row,2,t.$index)}}},[a._v("\n            冻结\n          ")]):a._e(),a._v(" "),1===t.row.batchState?n("el-button",{staticClass:"viewBotton",on:{click:function(e){a.handleEvent(t.row,5,t.$index)}}},[a._v("\n            解冻\n          ")]):a._e(),a._v(" "),n("a",{staticClass:"viewBottonOut",attrs:{href:a.outExcel(t.row,2)}},[a._v("\n           导出全部信息\n          ")]),a._v(" "),n("a",{staticClass:"viewBottonOut",attrs:{href:a.outExcel(t.row,1)}},[a._v("\n            导出卡号\n          ")])]}}])})],1),a._v(" "),10<a.total?n("el-row",{staticClass:"pagination"},[n("el-col",{attrs:{span:10,offset:5}},[n("el-pagination",{attrs:{"current-page":a.currentPage,"page-sizes":[10,20,30,40],"page-size":a.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)],1):a._e()],1)])};n._withStripped=!0;var o=a(22),r=a.n(o),l=a(59),s=a(69),i=a(68),c={data:function(){return{searchForm:{redeemCode:"",createStartTime:"",createEndTime:"",batchState:"0",publishType:"",applyPurpose:"",applyDepartment:""},createTime:"",tableData:[],tableParams:{firstResult:0,maxResult:20,batchState:"0"},currentPage:1,pageSize:20,total:0}},components:{},methods:{outExcel:function(e,t){return s.a.exportRedeemDate.url+"?redeemCodeId="+e.id+"&type="+t},fromPublishType:function(e){return 1===e.publishType?"纸质码":0===e.publishType?"电子码":void 0},fromTime:function(e){return e.startTime+"至"+e.endTime},fromBatchState:function(e){var t="";switch(e.batchState){case 0:t="正常";break;case 1:t="已冻结";break;case 2:t="已过期"}return t},fromApplyPurpose:function(e){var t="";switch(e.applyPurpose){case 0:t="厂商购买";break;case 1:t="院方采购";break;case 2:t="内部测试";break;case 3:t="平台赠送"}return t},fromApplyDepartment:function(e){var t="";switch(e.applyDepartment){case 0:t="市场运营部";break;case 1:t="商务部";break;case 2:t="协会事业部";break;case 3:t="测试部";break;case 4:t="产品部"}return t},getTableData:function(){var a=this;i.default.openLoading("加载中..."),Object(l.a)({method:s.a.getRedeemCodeList.type,url:s.a.getRedeemCodeList.url,params:this.tableParams}).then(function(e){if(i.default.closeLoading(),e&&e.data&&e.data.responseObject&&e.data.responseObject.responseData){var t=e.data.responseObject.responseData;t.items?(a.tableData=t.items,a.total=e.data.responseObject.responseData.total):(a.tableData=[],a.total=0)}else a.tableData=[],a.$allin_confirm({title:"提示",content:"查询失败",type:"notice"})}).catch(function(e){i.default.closeLoading(),a.$allin_confirm({title:"提示",content:"查询失败",type:"notice"})})},createCodeBtn:function(){var e=this.$router.resolve({path:"/createCode"});window.open(e.href,"_blank")},handleEvent:function(e,t,a){switch(t){case 1:var n=this.$router.resolve({path:"/createCode",query:{redeemCodeId:e.id}});window.open(n.href,"_blank");break;case 2:this.freezeCode(e,a);break;case 3:case 4:break;case 5:this.unfreezeCode(e,a)}},freezeCodeTip:function(e,t){var a=this;a.$confirm("冻结后已发放的兑换码无法正常兑换，已兑换成功的课程仍可正常观看，是否确认？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){a.freezeCodeApi(e,t,1,function(e){a.searchForm.batchState.toString()?a.tableData.splice(t,1):a.tableData[t].batchState=1,a.$message({type:"success",message:"已成功冻结"+e.responseData.count+"条数据",onClose:function(){}})})}).catch(function(){})},freezeCodeApi:function(e,t,a,n){var o=this;i.default.openLoading("加载中..."),Object(l.a)({method:s.a.frozenOrThaw.type,url:s.a.frozenOrThaw.url,data:{redeemCodeId:e.id,type:a}}).then(function(e){i.default.closeLoading(),e&&e.data&&e.data.responseObject&&e.data.responseObject.responseData&&e.data.responseObject.responseData.count?n&&n(e.data.responseObject):1==a?o.$message.error("冻结失败"):o.$message.error("解冻失败")}).catch(function(e){i.default.closeLoading(),1==a?o.$message.error("冻结失败"):o.$message.error("解冻失败")})},freezeCode:function(t,a){var n=this,o=this;i.default.openLoading("加载中..."),Object(l.a)({method:s.a.checkHaveNoUse.type,url:s.a.checkHaveNoUse.url,params:{redeemCodeId:t.id}}).then(function(e){i.default.closeLoading(),e&&e.data&&e.data.responseObject&&e.data.responseObject.responseStatus?e.data.responseObject.responseData?o.freezeCodeTip(t,a):n.$alert("该批次下兑换码已全部被使用，不允许冻结","提示",{confirmButtonText:"确定",callback:function(e){}}):n.$allin_confirm({title:"提示",content:"查询失败",type:"notice"})}).catch(function(e){i.default.closeLoading()})},unfreezeCode:function(e,t){var a=this;a.$confirm("是否确认解冻该批次兑换码？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){a.freezeCodeApi(e,t,2,function(e){a.searchForm.batchState.toString()?a.tableData.splice(t,1):a.tableData[t].batchState=0,a.$message({type:"success",message:"已成功解冻"+e.responseData.count+"条数据",onClose:function(){}})})}).catch(function(){})},onSubmit:function(){Array.isArray(this.createTime)&&0<this.createTime.length?(this.searchForm.createStartTime=this.createTime[0],this.searchForm.createEndTime=this.createTime[1]):(this.searchForm.createStartTime="",this.searchForm.createEndTime="");var e={};for(var t in this.searchForm)this.searchForm[t].toString()&&(e[t]=this.searchForm[t]);this.tableParams=this.deepExtend({},{firstResult:0,maxResult:20},e),this.pageSize=20,this.currentPage=1,this.getTableData()},resetForm:function(){this.$refs.codeBatchForm.resetFields(),this.createTime=[]},deepExtend:function(e){e=e||{};for(var t=1;t<arguments.length;t++){var a=arguments[t];if(a)for(var n in a)a.hasOwnProperty(n)&&("object"===r()(a[n])?e[n]=this.deepExtend(e[n],a[n]):e[n]=a[n])}return e},handleSizeChange:function(e){this.pageSize=e,this.tableParams.maxResult=this.pageSize,this.tableParams.firstResult=0,this.currentPage=0,this.getTableData()},handleCurrentChange:function(e){this.currentPage=e,this.tableParams.firstResult=(this.currentPage-1)*this.pageSize,this.getTableData()}},mounted:function(){var t=this;this.getTableData(),document.onkeydown=function(e){13===e.keyCode&&(!t.bigImgDialogVisible||t.videoDialogVisible||t.reviewDialogVisible||t.yunYunDetailDialogVisible||t.likeDialogVisible)&&t.onSubmit()}},destroyed:function(){document.onkeydown=null,i.default.goBack()},watch:{}},p=(a(863),a(58)),u=Object(p.a)(c,n,[],!1,null,null,null);u.options.__file="src/views/redeemCode/codeBatch.vue";t.default=u.exports}}]);