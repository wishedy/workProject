(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{583:function(e,t,i){var n=i(762);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(156)(n,o);n.locals&&(e.exports=n.locals)},584:function(e,t,i){var n=i(764);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(156)(n,o);n.locals&&(e.exports=n.locals)},585:function(e,t,i){var n=i(766);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};i(156)(n,o);n.locals&&(e.exports=n.locals)},761:function(e,t,i){"use strict";var n=i(583);i.n(n).a},762:function(e,t,i){(e.exports=i(155)(!1)).push([e.i,'\n.uploadContainer .noEdit[data-v-bf60ea14] {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 3px;\n  background: rgba(0, 0, 0, 0.8);\n  text-align: center;\n  line-height: 100px;\n  font-size: 14px;\n  color: #FFFFFF;\n  letter-spacing: 0;\n  z-index: 5;\n  top: 0;\n}\n.uploadContainer ul li[data-v-bf60ea14] {\n  display: inline-block;\n  vertical-align: middle;\n  width: 100px;\n  height: 100px;\n  margin-right: 20px;\n  margin-bottom: 20px;\n  position: relative;\n}\n.uploadContainer ul li img[data-v-bf60ea14] {\n    width: 100px;\n    height: 100px;\n}\n.uploadContainer ul li i[data-v-bf60ea14] {\n    position: absolute;\n    top: 0;\n    right: 0;\n    background: #000000;\n    width: 20px;\n    height: 20px;\n    font-size: 20px;\n    line-height: 20px;\n    text-align: center;\n    display: block;\n    color: #fff;\n    cursor: pointer;\n}\n.uploadContainer .addImg[data-v-bf60ea14] {\n  display: inline-block;\n  vertical-align: middle;\n  margin-right: 20px;\n  margin-bottom: 20px;\n  cursor: pointer;\n  width: 100px;\n  height: 100px;\n  position: relative;\n  text-align: center;\n  background: #EDF1FF;\n  border-radius: 3px;\n}\n.uploadContainer .addImg i[data-v-bf60ea14] {\n    /*display: inline-block;*/\n    width: 38px;\n    height: 31px;\n    /*vertical-align: middle;*/\n    background: url("/static/images/upload/addImg.png") no-repeat;\n    /*margin: 45px 0 6px 0;*/\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translateX(-50%) translateY(-50%);\n}\n.uploadContainer input[data-v-bf60ea14] {\n  width: 100px;\n  height: 100px;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  position: absolute;\n  opacity: 0;\n}\n.uploadContainer .ev-bigImg[data-v-bf60ea14] {\n  position: fixed;\n  right: 0;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  z-index: 6;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.uploadContainer .ev-bigImg img[data-v-bf60ea14] {\n    max-width: 80%;\n    max-height: 80%;\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n}\n',""])},763:function(e,t,i){"use strict";var n=i(584);i.n(n).a},764:function(e,t,i){(e.exports=i(155)(!1)).push([e.i,'\n.uploadContainer .noEdit[data-v-713a8ae0] {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 3px;\n  background: rgba(0, 0, 0, 0.8);\n  text-align: center;\n  line-height: 100px;\n  font-size: 14px;\n  color: #FFFFFF;\n  letter-spacing: 0;\n  z-index: 5;\n  top: 0;\n}\n.uploadContainer .playIcon[data-v-713a8ae0] {\n  position: absolute;\n  width: 40px;\n  height: 40px;\n  background: url("/static/images/upload/video play_blue.png") no-repeat;\n  top: 50%;\n  left: 50%;\n  transform: translateY(-50%) translateX(-50%);\n}\n.uploadContainer ul[data-v-713a8ae0] {\n  position: relative;\n}\n.uploadContainer ul li[data-v-713a8ae0] {\n    display: inline-block;\n    vertical-align: middle;\n    width: 100px;\n    height: 100px;\n    margin-right: 20px;\n    /*margin-bottom: 20px;*/\n    position: relative;\n}\n.uploadContainer ul li .uploadCon[data-v-713a8ae0] {\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.7);\n      top: 0;\n}\n.uploadContainer ul li .uploadCon p[data-v-713a8ae0] {\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        -ms-transform: translate(-50%, -50%);\n        -moz-transform: translate(-50%, -50%);\n        -webkit-transform: translate(-50%, -50%);\n        -o-transform: translate(-50%, -50%);\n        font-size: 13px;\n        color: #fff;\n        line-height: 1;\n}\n.uploadContainer ul li .uploadCon .uploadPending i[data-v-713a8ae0] {\n        display: block;\n        width: 28px;\n        height: 28px;\n        background: url(/static/images/upload/loading.png) no-repeat;\n        margin: 0 auto 5px;\n        animation: rotate-data-v-713a8ae0 1s linear infinite;\n        -webkit-animation: rotate-data-v-713a8ae0 1s linear infinite;\n}\n.uploadContainer ul li .uploadCon .uploadFail[data-v-713a8ae0] {\n        font-size: 14px;\n        white-space: nowrap;\n        line-height: 16px;\n        text-align: center;\n}\n.uploadContainer ul li img[data-v-713a8ae0] {\n      width: 100px;\n      height: 100px;\n}\n.uploadContainer ul li .itemClose[data-v-713a8ae0] {\n      position: absolute;\n      top: 0;\n      right: 0;\n      background: #000000;\n      width: 20px;\n      height: 20px;\n      font-size: 20px;\n      line-height: 20px;\n      text-align: center;\n      display: block;\n      color: #fff;\n      cursor: pointer;\n}\n.uploadContainer .addCon[data-v-713a8ae0] {\n  display: inline-block;\n  vertical-align: middle;\n  margin-right: 20px;\n  /*margin-bottom: 20px;*/\n}\n.uploadContainer .addImg[data-v-713a8ae0] {\n  /*display: inline-block;*/\n  /*vertical-align: middle;*/\n  cursor: pointer;\n  width: 100px;\n  height: 100px;\n  position: relative;\n  text-align: center;\n  background: #EDF1FF;\n  border-radius: 3px;\n}\n.uploadContainer .addImg i[data-v-713a8ae0] {\n    /*display: inline-block;*/\n    width: 38px;\n    height: 31px;\n    /*vertical-align: middle;*/\n    background: url("/static/images/upload/addImg.png") no-repeat;\n    /*margin: 45px 0 6px 0;*/\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translateX(-50%) translateY(-50%);\n}\n.uploadContainer input[data-v-713a8ae0] {\n  width: 100px;\n  height: 100px;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  position: absolute;\n  opacity: 0;\n}\n@keyframes rotate-data-v-713a8ae0 {\n0% {\n    transform: rotate(0);\n    -ms-transform: rotate(0);\n    -moz-transform: rotate(0);\n    -webkit-transform: rotate(0);\n    -o-transform: rotate(0);\n}\n100% {\n    transform: rotate(360deg);\n    -ms-transform: rotate(360deg);\n    -moz-transform: rotate(360deg);\n    -webkit-transform: rotate(360deg);\n    -o-transform: rotate(360deg);\n}\n}\n@-webkit-keyframes rotate-data-v-713a8ae0 {\n0% {\n    transform: rotate(0);\n    -ms-transform: rotate(0);\n    -moz-transform: rotate(0);\n    -webkit-transform: rotate(0);\n    -o-transform: rotate(0);\n}\n100% {\n    transform: rotate(360deg);\n    -ms-transform: rotate(360deg);\n    -moz-transform: rotate(360deg);\n    -webkit-transform: rotate(360deg);\n    -o-transform: rotate(360deg);\n}\n}\n',""])},765:function(e,t,i){"use strict";var n=i(585);i.n(n).a},766:function(e,t,i){(e.exports=i(155)(!1)).push([e.i,'\n.listEditCon {\n  max-width: 1200px;\n  margin: auto;\n  /* .el-select .el-input.is-focus .el-input__inner,.el-select .el-input__inner:focus{\n    border-color: #4B67D6!important;\n  }*/\n}\n.listEditCon .listForm {\n    background: #FFFFFF;\n    box-shadow: 0 4px 10px 0 rgba(42, 53, 102, 0.04);\n    border-radius: 3px;\n    padding: 27px 0 40px 44px;\n    margin-bottom: 55px;\n}\n.listEditCon .listName {\n    width: 300px;\n    height: 32px;\n}\n.listEditCon .editTitle {\n    font-size: 20px;\n    color: #222222;\n    letter-spacing: 0;\n    line-height: 20px;\n    margin: 37px 0 25px;\n}\n.listEditCon .el-textarea__inner {\n    width: 640px;\n    height: 90px;\n    background: #F7F9FC;\n    border: 1px solid #E6E6E8;\n    border-radius: 3px;\n    resize: none;\n}\n.listEditCon .el-input__inner {\n    background: #F7F9FC;\n    border: 1px solid #E6E6E8;\n    border-radius: 3px;\n    height: 32px;\n}\n.listEditCon .el-radio__inner {\n    border: 1px solid #C8CACC;\n}\n.listEditCon .el-radio__inner::after {\n    width: 8px;\n    height: 8px;\n    background: #4B67D6;\n    border-radius: 50%;\n}\n.listEditCon .el-radio__input.is-checked .el-radio__inner {\n    border: 1px solid #4B67D6;\n    width: 14px;\n    height: 14px;\n    background: white;\n    border-radius: 50%;\n}\n.listEditCon .el-radio__input.is-checked + .el-radio__label {\n    color: #222;\n}\n.listEditCon .el-button {\n    padding: 8px 55px;\n    border-radius: 3px;\n    background: #A1A8C0;\n    font-size: 14px;\n    color: #FFFFFF;\n    letter-spacing: 0;\n    line-height: 14px;\n}\n.listEditCon .el-button--primary {\n    background: #3846DC;\n    border: none;\n}\n.listEditCon .el-button {\n    border: none;\n}\n.listEditCon .el-button + .el-button {\n    margin-left: 25px;\n}\n.listEditCon .el-radio {\n    color: #999;\n}\n.listEditCon .el-form-item__label, .listEditCon .el-form-item__content {\n    line-height: 32px;\n    font-size: 14px;\n    color: #555555;\n}\n.listEditCon .el-input__icon {\n    line-height: 32px;\n}\n.listEditCon .el-form-item {\n    margin-bottom: 20px;\n}\n.listEditCon .el-form-item:nth-child(8) {\n      margin-bottom: 60px;\n}\n.listEditCon .el-form-item:last-child {\n      margin-bottom: 0;\n}\n.listEditCon .el-form-item.is-success .el-input__inner, .listEditCon .el-form-item.is-success .el-textarea__inner {\n    border-color: #E6E6E8 !important;\n}\n.listEditCon .el-form-item.is-success .el-input__inner, .listEditCon .el-form-item.is-success .el-input__inner:focus, .listEditCon .el-form-item.is-success .el-textarea__inner, .listEditCon .el-form-item.is-success .el-textarea__inner:focus {\n    border-color: #E6E6E8 !important;\n}\n.listEditCon .el-button:active, .listEditCon .el-button:focus, .listEditCon .el-button:hover {\n    background: #a1a8c0 !important;\n    border: none !important;\n    color: #fff !important;\n}\n.listEditCon .el-button--primary:focus, .listEditCon .el-button--primary:hover, .listEditCon .el-button--primary.is-active, .listEditCon .el-button--primary:active {\n    background: #3846DC !important;\n    border: none !important;\n    color: #fff !important;\n}\n.listEditCon .el-input.is-active .el-input__inner, .listEditCon .el-input__inner:focus, .listEditCon .el-textarea__inner:focus {\n    border-color: #e6e6e8 !important;\n}\n.el-select-dropdown.is-multiple .el-select-dropdown__item.selected, .el-select-dropdown__item.selected {\n  color: #4B67D6 !important;\n}\n.listEditCon.ev-replyEdit .mediaRadio {\n  position: relative;\n}\n.listEditCon.ev-replyEdit .mediaRadio .medioSelet {\n    cursor: pointer;\n    position: absolute;\n    left: -86px;\n    top: 9px;\n    width: 14px;\n    height: 14px;\n    background: url("/static/images/upload/radio_default.png") no-repeat;\n}\n.listEditCon.ev-replyEdit .mediaRadio.active .medioSelet {\n    background: url("/static/images/upload/radio_selected.png") no-repeat;\n}\n.listEditCon.ev-replyEdit .el-input__prefix {\n  right: 5px !important;\n  left: auto !important;\n}\n.listEditCon.ev-replyEdit .el-input--prefix .el-input__inner {\n  padding-left: 15px !important;\n}\n.listEditCon.ev-replyEdit .detaileDesc {\n  background: #fff;\n  margin-bottom: 20px;\n  padding: 25px 0 35px 30px;\n}\n.listEditCon.ev-replyEdit .detaileDesc .detaileTitle .descTitle {\n    font-size: 18px;\n    color: #222222;\n    letter-spacing: 0;\n    display: inline-block;\n    vertical-align: middle;\n}\n.listEditCon.ev-replyEdit .detaileDesc .detaileTitle .descTitle:before {\n      content: \'\';\n      width: 6px;\n      height: 6px;\n      display: inline-block;\n      vertical-align: middle;\n      background: #4B67D6;\n      border-radius: 50%;\n      margin-right: 7px;\n}\n.listEditCon.ev-replyEdit .detaileDesc .detaileTitle span {\n    font-size: 13px;\n    color: #6B748C;\n    letter-spacing: 0;\n    line-height: 14px;\n    display: inline-block;\n    vertical-align: middle;\n    border: 1px solid #4B67D6;\n    border-radius: 3px;\n    padding: 6px 17px;\n    margin-left: 8px;\n}\n.listEditCon.ev-replyEdit .detaileDesc .descName {\n    font-size: 14px;\n    color: #555555;\n    letter-spacing: 0;\n    margin-top: 6px;\n    margin-left: 13px;\n}\n.listEditCon.ev-replyEdit .el-form-item.is-success .el-textarea__inner {\n  border-color: #E6E6E8;\n}\n.listEditCon.ev-replyEdit .el-input.is-disabled .el-input__inner {\n  color: #606266;\n}\n.listEditCon.ev-replyEdit .el-form-item:nth-child(8) {\n  margin-bottom: 20px;\n}\n.listEditCon.ev-replyEdit .el-form-item:nth-child(2) {\n  margin-bottom: 20px;\n}\n.listEditCon.ev-replyEdit .el-form-item:nth-child(10) {\n  margin-bottom: 60px;\n}\n.listEditCon.ev-replyEdit .el-input__icon.el-icon-search {\n  cursor: pointer;\n}\n.listEditCon.ev-replyEdit .el-form-item.is-required.mediaRadio .el-form-item__label:before {\n  margin-right: 22px;\n}\n.listEditCon .el-form-item.is-error .el-input__inner, .listEditCon .el-form-item.is-error .el-input__inner:focus, .listEditCon .el-form-item.is-error .el-textarea__inner, .listEditCon .el-form-item.is-error .el-textarea__inner:focus, .listEditCon .el-message-box__input input.invalid, .listEditCon .el-message-box__input input.invalid:focus {\n  border-color: #f56c6c !important;\n}\n',""])},954:function(e,t,i){"use strict";i.r(t);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"listEditCon ev-replyEdit"},[t._m(0),t._v(" "),i("section",{staticClass:"detaileDesc"},[i("section",{staticClass:"detaileTitle"},[t.dataInfoBox.questionName?i("h2",{staticClass:"descTitle"},[t._v(t._s(t.dataInfoBox.questionName?t.dataInfoBox.questionName:""))]):t._e(),t._v(" "),t.dataInfoBox.isValid?i("span",[t._v(t._s(1==t.dataInfoBox.isValid?"上架":"下架"))]):t._e()]),t._v(" "),i("p",{staticClass:"descName"},[t._v(t._s(t.brochureName?"锦囊名："+t.brochureName:""))])]),t._v(" "),i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm listForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"回复内容",prop:"response"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.response,callback:function(e){t.$set(t.ruleForm,"response",e)},expression:"ruleForm.response"}})],1),t._v(" "),i("el-form-item",{staticClass:"mediaRadio",class:{active:1==t.isVideo},attrs:{label:"添加图片",prop:"addImg"}},[i("span",{staticClass:"medioSelet",on:{click:function(e){t.medioSelet(1)}}}),t._v(" "),i("upload-img-list",{attrs:{isEdit:t.isVideo,imgListArr:t.imgListArr,formData:t.paramData},on:{imgpk:t.imgpk}})],1),t._v(" "),i("el-form-item",{staticClass:"mediaRadio",class:{active:2==t.isVideo},attrs:{label:"添加视频",prop:"addVideo"}},[i("span",{staticClass:"medioSelet",on:{click:function(e){t.medioSelet(2)}}}),t._v(" "),i("upload-video",{attrs:{isEdit:t.isVideo,videoListArr:t.videoListArr,formData:t.formData},on:{videoBack:t.videoBack}})],1),t._v(" "),i("el-form-item",{attrs:{label:"回复排序",prop:"responeSort"}},[i("el-input",{staticClass:"listName",attrs:{placeholder:"请输入回复排序"},model:{value:t.ruleForm.responeSort,callback:function(e){t.$set(t.ruleForm,"responeSort",e)},expression:"ruleForm.responeSort"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"资源类型",prop:"region"}},[i("el-select",{staticClass:"listName",attrs:{placeholder:"请选择资源类型"},model:{value:t.ruleForm.region,callback:function(e){t.$set(t.ruleForm,"region",e)},expression:"ruleForm.region"}},t._l(t.citeTypeArr,function(e){return i("el-option",{key:e.id,attrs:{label:e.typeName,value:e.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"资源ID",prop:"resorceId"}},[i("el-input",{staticClass:"listName",attrs:{placeholder:"请输入资源ID"},model:{value:t.ruleForm.resorceId,callback:function(e){t.$set(t.ruleForm,"resorceId",e)},expression:"ruleForm.resorceId"}},[i("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},on:{click:t.searchResorce},slot:"prefix"})])],1),t._v(" "),i("el-form-item",{attrs:{label:"资源名",prop:"resorceName"}},[i("el-input",{staticClass:"listName",attrs:{type:"text",disabled:"disabled",placeholder:"请检索资源名称"},model:{value:t.ruleForm.resorceName,callback:function(e){t.$set(t.ruleForm,"resorceName",e)},expression:"ruleForm.resorceName"}})],1),t._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0<t.nodeArr.length,expression:"nodeArr.length>0"}],attrs:{label:"资源锚点选择",prop:"resorceSelet"}},[i("el-select",{staticClass:"listName",attrs:{placeholder:"请选择"},model:{value:t.ruleForm.resorceSelet,callback:function(e){t.$set(t.ruleForm,"resorceSelet",e)},expression:"ruleForm.resorceSelet"}},t._l(t.nodeArr,function(e){return i("el-option",{key:e.nodeId,attrs:{label:e.nodeDesc,value:e.nodeId}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"状态",prop:"resource"}},[i("el-radio-group",{model:{value:t.ruleForm.resource,callback:function(e){t.$set(t.ruleForm,"resource",e)},expression:"ruleForm.resource"}},[i("el-radio",{attrs:{label:"上架"}}),t._v(" "),i("el-radio",{attrs:{label:"下架"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"备注",prop:"desc"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.desc,callback:function(e){t.$set(t.ruleForm,"desc",e)},expression:"ruleForm.desc"}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")]),t._v(" "),i("el-button",{on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("返回")])],1)],1)],1)};n._withStripped=!0;var r=i(59),a=i(69),l=i(68),o=function(){var n=this,e=n.$createElement,o=n._self._c||e;return o("div",{staticClass:"uploadContainer"},[o("ul",[o("div",{staticClass:"addImg"},[o("i"),n._v(" "),o("input",{ref:"referenceUpload",staticClass:"ev-uploadImg",attrs:{type:"file",name:"file",accept:"image/jpeg,image/jpg,image/png",multiple:""},on:{change:n.inputChange}}),n._v(" "),2==n.isEdit?o("p",{staticClass:"noEdit"},[n._v("无法上传")]):n._e()]),n._v(" "),n._l(n.imgList,function(t,i){return o("li",{staticClass:"ev-imgList"},[o("img",{attrs:{src:t.src||t},on:{mouseover:function(e){n.bigImgShow(t.src||t)}}}),n._v(" "),o("i",{on:{click:function(e){n.itemClose(i,t)}}},[n._v("×")]),n._v(" "),2==n.isEdit?o("p",{staticClass:"noEdit"},[n._v("无法编辑")]):n._e()])})],2),n._v(" "),n.bigImgDialogVisible?o("div",{staticClass:"ev-bigImg",on:{click:n.closeBigImg}},[o("img",{attrs:{src:n.bigImgPath}})]):n._e()])},s={props:["isEdit","imgListArr","formData"],data:function(){return{loading:null,imgList:this.imgListArr,prevFile:"",fileSize:2097152,sortid:this.imgListArr.length,imgLength:0,imgListChange:[],imgpk:{responsePk:"",deletId:""},bigImgPath:"",bigImgDialogVisible:!1}},watch:{imgListArr:{handler:function(e){this.imgList=e},deep:o._withStripped=!0}},methods:{closeBigImg:function(){this.bigImgDialogVisible=!1},bigImgShow:function(e){e&&(this.bigImgPath=e,this.bigImgDialogVisible=!0)},itemClose:function(e,t){if(this.imgList.splice(e,1),t.id)this.imgpk.deletId+=t.id+",";else for(var i=0;i<this.imgListChange.length;i++)this.imgListChange[i].src==t&&(this.imgpk.responsePk=this.imgpk.responsePk.replace(this.imgListChange[i].responsePk+",",""));this.$emit("imgpk",this.imgpk)},inputChange:function(e){var t=this.$refs.referenceUpload.files;if(this.imgLength=t.length,9<this.imgList.length+this.imgLength)return this.$alert("","最多上传9张图片",{confirmButtonText:"确定"}),!1;for(var i=0;i<t.length;i++)if(t[i])if(t[i].size>this.fileSize)alert("上传失败，请上传不大于2M的图片！"),this.imgLength--,0==this.imgLength&&this.loading&&this.loading.close();else if(/(jpg)|(jpeg)|(png)$/i.test(t[i].type)){this.prevFile=t[i],this.sortid++;var n=this.localURL(t[i]);this.imgList.unshift(n),this.loading=this.$loading({lock:!0,text:"图片上传中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.compressImg(t[i],{src:n},this.sortid)}else alert("格式不支持，请选择jpg、png、jpeg");else this.prevFile&&this.localURL(this.prevFile)},localURL:function(e){var t=null;return null!=window.createObjectURL?t=window.createObjectURL(e):null!=window.URL?t=window.URL.createObjectURL(e):null!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t},compressImg:function(t,i,n){var o=new FileReader,r=new Image,a=this;o.readAsDataURL(t),o.onload=function(e){r.src=e.target.result,t.size<a.fileSize?(a.formData.extName=t.type.split("/")[1],a.formData.fileContent=o.result.split(",")[1],a.formData.isValid=0,a.formData.sortId=n,a.formData.waterType=2,a.uploadAction(a.formData,i)):(a.imgLength--,0==a.imgLength&&a.loading.close())}},uploadAction:function(i,n){var o=this;r.a.post(a.a.attachment.url,i).then(function(e){if((e=e.data)&&e.responseObject&&e.responseObject.responseData&&e.responseObject.responseData.data_list)o.uploadSave(e.responseObject.responseData.data_list,i,n);else{for(var t=0;t<o.imgList.length;t++)o.imgList[t]==n.src&&o.imgList.splice(t,1);o.imgLength--,0==o.imgLength&&o.loading.close(),alert("上传失败")}})},uploadSave:function(e,t,i){var n=this,o={sendSiteId:25,brochureId:t.brochureId,questionId:t.questionId,answerId:t.answerId,categoryType:t.categoryType,isValid:0,attUrl:e.attUrl,attSize:e.attSize,attHeight:e.attHeight,attWidth:e.attWidth,attFormat:e.extName,sortId:t.sortId};r.a.post(a.a.saveAttachment.url,o).then(function(e){if(n.imgLength--,0==n.imgLength&&n.loading.close(),(e=e.data)&&e.responseObject.responsePk)n.imgpk.responsePk+=e.responseObject.responsePk+",",i.responsePk=e.responseObject.responsePk,n.imgListChange.unshift(i),n.$emit("imgpk",n.imgpk);else{for(var t=0;t<n.imgList.length;t++)n.imgList[t]==i.src&&n.imgList.splice(t,1);alert("保存失败")}})}}},d=(i(761),i(58)),p=Object(d.a)(s,o,[],!1,null,"bf60ea14",null);p.options.__file="src/components/common/upload/uploadImgList.vue";var c=p.exports,u=function(){var n=this,e=n.$createElement,o=n._self._c||e;return o("div",{staticClass:"uploadContainer"},[o("ul",[n.isUpload?n._e():o("div",{staticClass:"addCon",attrs:{id:"ev-videoCon"}},[n._m(0)]),n._v(" "),1==n.isEdit?o("div",{staticClass:"addCon",staticStyle:{position:"absolute",left:"0","z-index":"5"}},[n._m(1)]):n._e(),n._v(" "),n._l(n.videoList,function(t,i){return o("li",{staticClass:"ev-videoList"},[n.onProgressStatus?o("div",{staticClass:"uploadCon"},[n.isUpload?o("p",{staticClass:"uploadPending"},[o("i"),o("span",[n._v(n._s(n.uloadPending)+"%")])]):n._e(),n._v(" "),!n.isUpload&&n.isFail?o("p",{staticClass:"uploadFail"},[n._v("上传失败"),o("br"),o("span",[n._v("请重新上传")])]):n._e()]):n._e(),n._v(" "),n.onProgressStatus?n._e():o("img",{attrs:{src:t.imgSrc||t}}),n._v(" "),n.uloadPendingState||t.isValid?o("i",{staticClass:"itemClose",on:{click:function(e){n.itemClose(i,t)}}},[n._v("×")]):n._e(),n._v(" "),1==n.isEdit?o("p",{staticClass:"noEdit"},[n._v("无法编辑")]):n._e(),n._v(" "),t.videoPath?o("span",{staticClass:"playIcon"}):n._e()])})],2)])};u._withStripped=!0;var m={props:{isEdit:{type:Number},videoListArr:{type:Array},formData:{type:Object}},data:function(){return{videoList:this.videoListArr||[],isUpload:!1,isFail:!1,uloadPending:0,uloadPendingState:!1,videoBack:{responsePk:"",deletId:""},onProgressStatus:!1}},watch:{videoListArr:{handler:function(e){this.videoList=e},deep:!0}},methods:{itemClose:function(e,t){if(t.isValid)this.videoBack.deletId+=t.id+",";else for(var i=0;i<this.videoList.length;i++)this.videoList[i].id==t.id&&(this.videoBack.responsePk=this.videoBack.responsePk.replace(t.id+",",""));this.isUpload=!1;var n=this;setTimeout(function(){n.uploadVideo()},1e3),this.videoList.splice(e,1),this.onProgressStatus=!1,this.$emit("videoBack",this.videoBack)},uploadVideo:function(){var r=this;r.uploader=Qiniu.uploader({runtimes:"html5,flash,html4",browse_button:"ev-addVideo",container:"ev-videoCon",drop_element:"ev-videoCon",multi_selection:"",flash_swf_url:"//paas.allinmd.cn/modules/video_upload/plupload/Moxie.swf",dragdrop:!0,chunk_size:"4mb",uptoken_url:a.a.getQiniuToken.url,domain:"//api.allinmd.cn",get_new_uptoken:!1,filters:{mime_types:[{title:"video",extensions:"mp4,mov,avi,wmv"}],prevent_duplicates:!0},auto_start:!0,init:{BeforeUpload:function(e,t){var i=r.getName(t.name),n=i.fileName,o=i.suffixName;r.isUpload=!0,r.onProgressStatus=!0,r.videoList.unshift({imgSrc:""}),/(mp4)|(mov)|(avi)|(wmv)|(flv)$/i.test(o)?10485760<t.size&&(r.uploader.removeFile(r.uploader.getFile(t.id)),alert("视频过大，请联系在线客服寻求帮助"),r.onProgressStatus=!1,r.isUpload=!1):(r.uploader.removeFile(r.uploader.getFile(t.id)),alert("格式不支持，请选择mov、mp4、avi、wmv、flv"),r.onProgressStatus=!1,r.isUpload=!1),r.onProgressStatus?r.videoName=15<n.length?n.substring(0,15)+"...."+o:n+"."+o:r.videoList.splice(0,1)},UploadProgress:function(e,t){r.uloadPending=t.percent,r.uloadPendingState=!1},UploadComplete:function(){},FileUploaded:function(e,t,i){if(i){var n=JSON.parse(i);r.saveVideo(n)}},Error:function(e,t,i){-601===t.code&&alert("格式不支持，请选择mov、mp4、avi、wmv、flv"),r.isFail=!0,r.isUpload=!1,setTimeout(function(){r.uploadVideo()},1e3)}}})},saveVideo:function(e){var t=this,i={key:e.key,persistentId:e.persistentId,videoName:t.videoName,refType:15,brochureId:t.formData.brochureId,questionId:t.formData.questionId,answerId:t.formData.answerId,isValid:"0",visitSiteId:25};r.a.post(a.a.videoInfo.url,i).then(function(e){t.uloadPendingState=!0,t.onProgressStatus=!1,t.videoList.splice(0,1),e&&e.data&&e.data.responseObject&&e.data.responseObject.responseStatus&&e.data.responseObject.responsePk?(t.videoList.unshift({imgSrc:"//img10.allinmd.cn/default/qiniu196_196.jpg",videoPath:"",id:e.data.responseObject.responsePk}),t.videoBack.responsePk+=e.data.responseObject.responsePk+",",t.$emit("videoBack",t.videoBack)):(t.isUpload=!1,alert("视频上传失败")),setTimeout(function(){t.uploadVideo()},1e3)})},getName:function(e){var t=e,i=t.lastIndexOf("/"),n=t.lastIndexOf("\\"),o=Math.max(i,n),r=t.lastIndexOf(".");return{fileName:t.substring(o+1,r),suffixName:t.substring(r+1,t.length)}}},mounted:function(){this.uploadVideo()}},g=(i(763),Object(d.a)(m,u,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"addImg",attrs:{id:"ev-addVideo"}},[t("i")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"addImg"},[t("p",{staticClass:"noEdit"},[this._v("无法上传")])])}],!1,null,"713a8ae0",null));g.options.__file="src/components/common/upload/UploadVideo.vue";var f=g.exports,h=(i(72),{data:function(){return{picIds:"",delPicIds:"",videoId:"",vDelete:"",formData:{brochureId:"",questionId:"",answerId:""},paramData:{brochureId:"",questionId:"",answerId:"",categoryType:3,visitSiteId:25},nodeIdVal:"",nodeArr:[],bId:"",qId:"",aId:"",id:"",brochureName:"",dataInfoBox:"",citeTypeArr:[{id:"1",typeName:"视频"},{id:"2",typeName:"文库"},{id:"7",typeName:"病例"}],ruleForm:{response:"",addVideo:"",addImg:"",responeSort:"",region:"1",resorceName:"",resorceId:"",resorceSelet:"",resource:"下架",desc:""},imgListArr:[],videoListArr:[],isVideo:0,rules:{response:[{required:!0,message:"请输入回复内容",trigger:"blur"},{validator:function(e,t,i){t&&600<l.default.getByteLen(t)?i(new Error("长度超过了600个字符")):i()}}],region:[{required:!0,message:"请选择资源类型",trigger:"blur"}],addImg:[{required:!1,validator:function(e,t,i){e.required?document.getElementsByClassName("ev-imgList")[0]?i():i(new Error("请上传图片")):i()}}],addVideo:[{required:!1,validator:function(e,t,i){if(e.required){var n=document.getElementsByClassName("ev-videoList")[0],o=n?n.getElementsByClassName("uploadPending")[0]:"",r=n?n.getElementsByClassName("uploadFail")[0]:"";!n||o||r?i(new Error("请上传视频")):i()}else i()}}],resorceId:[{required:!0,message:"请输入资源ID",trigger:"blur"}],resorceName:[{required:!0,message:"请检索资源名称",trigger:"blur"}],responeSort:[{required:!1,message:"请输入回复排序",trigger:"blur"},{validator:function(e,t,i){t?/^[1-9]\d*$/.test(t)?i():i(new Error("请输入正整数")):i()}}],desc:[{validator:function(e,t,i){t&&100<l.default.getByteLen(t)?i(new Error("长度超过了100个字符")):i()}}]}}},components:{uploadImgList:c,uploadVideo:f},computed:{resChangeVal:function(){return"下架"==this.ruleForm.resource?1:2}},watch:{imgListArr:function(){this.imgListArr&&this.imgListArr.length&&0==this.isVideo&&(this.isVideo=1)},videoListArr:function(){this.videoListArr&&this.videoListArr.length&&0==this.isVideo&&(this.isVideo=2)},resChangeVal:function(){1==this.resChangeVal?this.rules.responeSort[0].required=!1:this.rules.responeSort[0].required=!0},isVideo:function(){var e=this;1==e.isVideo&&(e.rules.addImg[0].required=!0,e.rules.addVideo[0].required=!1),2==e.isVideo&&(e.rules.addImg[0].required=!1,e.rules.addVideo[0].required=!0)}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.saveInfo()})},resetForm:function(e){if(this.$refs[e].resetFields(),window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},searchResorce:function(){var t=this,i=this;i.ruleForm.resorceId&&i.ruleForm.region&&Object(r.a)({method:a.a.getResourceInfo.type,url:a.a.getResourceInfo.url,params:{resourceId:i.ruleForm.resorceId,resourceType:i.ruleForm.region}}).then(function(e){if(e&&e.data&&l.default.hasResponseData(e.data)){var t=e.data.responseObject.responseData;i.ruleForm.resorceName=t.refName?t.refName:"无此资源，请重新检索",t.dataList&&t.dataList.length?i.nodeArr=t.dataList:i.nodeArr=[]}else i.ruleForm.resorceName="无此资源，请重新检索",i.nodeArr=[]}).catch(function(e){l.default.closeLoading(),t.$allin_confirm({title:"提示",content:"搜索失败，请重试",type:"notice"})})},medioSelet:function(e){this.isVideo=e},videoBack:function(e){this.vDelete=e.deletId,this.videoId=e.responsePk},imgpk:function(e){this.picIds=e.responsePk,this.delPicIds=e.deletId},saveInfo:function(){var t=this,i=this;if("无此资源，请重新检索"==i.ruleForm.resorceName)return i.$alert("资源id："+i.ruleForm.resorceId+"无资源名称，请重新检索后提交","缺少引用资源名称",{confirmButtonText:"确定"}),!1;l.default.openLoading("加载中...");var e={brochureId:i.bId,questionId:i.qId,answerContent:i.ruleForm.response,isValid:"上架"==i.ruleForm.resource?"1":"0"};i.ruleForm.responeSort&&(e.sortId=i.ruleForm.responeSort),i.ruleForm.region&&(e.refType=i.ruleForm.region),i.ruleForm.resorceId&&(e.refId=i.ruleForm.resorceId),i.ruleForm.resorceSelet&&(e.nodeId=i.ruleForm.resorceSelet),i.ruleForm.desc&&(e.remark=i.ruleForm.desc),i.aId&&(e.answerId=i.aId),i.id&&(e.id=i.id),2==i.isVideo?(i.videoId&&0!=i.videoId&&(e.videoId=i.videoId.substr(0,i.videoId.length-1)),i.videoId&&0!=i.videoId&&(e.attType=2)):1==i.isVideo?(i.picIds&&(e.picIds=i.picIds.substr(0,i.picIds.length-1)),i.picIds&&(e.attType=1),i.delPicIds&&(e.delPicIds=i.delPicIds.substr(0,i.delPicIds.length-1))):e.attType=0,Object(r.a)({method:a.a.saveAnswer.type,url:a.a.saveAnswer.url,data:e}).then(function(e){if(l.default.closeLoading(),e&&e.data&&e.data.responseObject.responseStatus){if(window.history.length<=1)return i.$router.push({path:"questionInfo",query:{bId:i.bId,qId:i.qId}}),!1;i.$router.go(-1)}else alert("保存失败请重试")}).catch(function(e){l.default.closeLoading(),t.$allin_confirm({title:"提示",content:"保存失败，请重试",type:"notice"})})},dataInfo:function(){var t=this,i=this;Object(r.a)({method:a.a.getQueInfo.type,url:a.a.getQueInfo.url,params:{brochureId:i.bId,questionId:i.qId}}).then(function(e){e&&e.data&&l.default.hasResponseData(e.data)&&(i.dataInfoBox=e.data.responseObject.responseData.dataList)}).catch(function(e){l.default.closeLoading(),t.$allin_confirm({title:"提示",content:"获取失败，请刷新重试",type:"notice"})})},getInfo:function(){var t=this,i=this;Object(r.a)({method:a.a.kitsInfo.type,url:a.a.kitsInfo.url,params:{brochureId:i.bId}}).then(function(e){if(e&&e.data&&l.default.hasResponseData(e.data)){var t=e.data.responseObject.responseData.dataList[0];i.brochureName=t.brochureName}}).catch(function(e){l.default.closeLoading(),t.$allin_confirm({title:"提示",content:"获取失败，请刷新重试",type:"notice"})})},getAnswerInfo:function(){var t=this,s=this;l.default.openLoading("加载中..."),Object(r.a)({method:a.a.getAnswerById.type,url:a.a.getAnswerById.url,params:{brochureId:s.bId,questionId:s.qId,answerId:s.aId}}).then(function(e){if(l.default.closeLoading(),e&&e.data&&l.default.hasResponseData(e.data)){var t=e.data.responseObject.responseData.dataList[0],i=e.data.responseObject.responseData.picList,n=e.data.responseObject.responseData.videoList;if(s.ruleForm={response:t.answerContent,addVideo:"",addImg:"",responeSort:t.sortId,region:t.refType,resorceId:t.refId,resource:1==t.isValid?"上架":"下架",desc:t.remark},s.searchResorce(),t.nodeId&&(s.ruleForm.resorceSelet=parseInt(t.nodeId)),i&&i.length){s.isVideo=1;for(var o=0;o<i.length;o++){var r=i[o],a={src:r.picUrl,id:r.picId,sortId:r.sortId};s.imgListArr.push(a),s.picIds=r.picId+","}}n&&n.length&&(s.isVideo=2,s.videoId=n[0].videoId+",",s.videoListArr=[{imgSrc:n[0].videoPicUrl?n[0].videoPicUrl:"//img10.allinmd.cn/default/qiniu196_196.jpg",videoPath:n[0].videoUrl,id:n[0].videoId,isValid:1}])}}).catch(function(e){l.default.closeLoading(),t.$allin_confirm({title:"提示",content:"获取失败，请刷新重试",type:"notice"})})}},mounted:function(){var e=this;if(e.$route.query.bId&&e.$route.query.qId)e.bId=e.$route.query.bId,e.qId=e.$route.query.qId,e.formData.brochureId=e.bId,e.formData.questionId=e.qId,e.paramData.brochureId=e.bId,e.paramData.questionId=e.qId,e.getInfo(),e.dataInfo(),e.$route.query.aId&&e.$route.query.id&&(e.aId=e.$route.query.aId,e.id=e.$route.query.id,e.formData.answerId=e.aId,e.paramData.answerId=e.aId,e.getAnswerInfo());else{if(window.history.length<=1)return e.$router.push({path:"/"}),!1;e.$router.go(-1)}},destroyed:function(){document.onkeydown=null,l.default.goBack()}}),v=(i(765),Object(d.a)(h,n,[function(){var e=this.$createElement,t=this._self._c||e;return t("section",[t("h1",{staticClass:"editTitle"},[this._v("锦囊管理后台 > 回复编辑页")])])}],!1,null,null,null));v.options.__file="src/views/kitsList/replyEdit.vue";t.default=v.exports}}]);