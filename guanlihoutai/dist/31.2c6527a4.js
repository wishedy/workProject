(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{577:function(e,t,r){var i=r(750);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(156)(i,n);i.locals&&(e.exports=i.locals)},578:function(e,t,r){var i=r(752);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(156)(i,n);i.locals&&(e.exports=i.locals)},749:function(e,t,r){"use strict";var i=r(577);r.n(i).a},750:function(e,t,r){(e.exports=r(155)(!1)).push([e.i,'\n.uploadContainer .addImg[data-v-7fb24538] {\n  cursor: pointer;\n  width: 100px;\n  height: 100px;\n  position: relative;\n  text-align: center;\n  background: #EDF1FF;\n  border-radius: 3px;\n}\n.uploadContainer .addImg.hasImg[data-v-7fb24538] {\n    border: none;\n}\n.uploadContainer .addImg .closeImg[data-v-7fb24538] {\n    position: absolute;\n    top: 0;\n    right: 0;\n    background: #000000;\n    width: 20px;\n    height: 20px;\n    font-size: 20px;\n    line-height: 20px;\n    text-align: center;\n    display: block;\n    color: #fff;\n    cursor: pointer;\n}\n.uploadContainer .addImg .addImg[data-v-7fb24538] {\n    /*display: inline-block;*/\n    width: 38px;\n    height: 31px;\n    /*vertical-align: middle;*/\n    background: url("/static/images/upload/addImg.png") no-repeat;\n    /*margin: 45px 0 6px 0;*/\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translateX(-50%) translateY(-50%);\n}\n.uploadContainer .addImg img[data-v-7fb24538] {\n    width: 100px;\n    height: 100px;\n}\n.uploadContainer input[data-v-7fb24538] {\n  width: 100px;\n  height: 100px;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  position: absolute;\n  opacity: 0;\n}\n.uploadContainer .ev-bigImg[data-v-7fb24538] {\n  position: fixed;\n  right: 0;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  z-index: 5;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.uploadContainer .ev-bigImg img[data-v-7fb24538] {\n    max-width: 80%;\n    max-height: 80%;\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n}\n',""])},751:function(e,t,r){"use strict";var i=r(578);r.n(i).a},752:function(e,t,r){(e.exports=r(155)(!1)).push([e.i,"\n.listEditCon {\n  max-width: 1200px;\n  margin: auto;\n  /* .el-select .el-input.is-focus .el-input__inner,.el-select .el-input__inner:focus{\n    border-color: #4B67D6!important;\n  }*/\n}\n.listEditCon .listForm {\n    background: #FFFFFF;\n    box-shadow: 0 4px 10px 0 rgba(42, 53, 102, 0.04);\n    border-radius: 3px;\n    padding: 27px 0 40px 44px;\n    margin-bottom: 55px;\n}\n.listEditCon .listName {\n    width: 300px;\n    height: 32px;\n}\n.listEditCon .editTitle {\n    font-size: 20px;\n    color: #222222;\n    letter-spacing: 0;\n    line-height: 20px;\n    margin: 37px 0 25px;\n}\n.listEditCon .el-textarea__inner {\n    width: 640px;\n    height: 90px;\n    background: #F7F9FC;\n    border: 1px solid #E6E6E8;\n    border-radius: 3px;\n    resize: none;\n}\n.listEditCon .el-input__inner {\n    background: #F7F9FC;\n    border: 1px solid #E6E6E8;\n    border-radius: 3px;\n    height: 32px;\n}\n.listEditCon .el-radio__inner {\n    border: 1px solid #C8CACC;\n}\n.listEditCon .el-radio__inner::after {\n    width: 8px;\n    height: 8px;\n    background: #4B67D6;\n    border-radius: 50%;\n}\n.listEditCon .el-radio__input.is-checked .el-radio__inner {\n    border: 1px solid #4B67D6;\n    width: 14px;\n    height: 14px;\n    background: white;\n    border-radius: 50%;\n}\n.listEditCon .el-radio__input.is-checked + .el-radio__label {\n    color: #222;\n}\n.listEditCon .el-button {\n    padding: 8px 55px;\n    border-radius: 3px;\n    background: #A1A8C0;\n    font-size: 14px;\n    color: #FFFFFF;\n    letter-spacing: 0;\n    line-height: 14px;\n}\n.listEditCon .el-button--primary {\n    background: #3846DC;\n    border: none;\n}\n.listEditCon .el-button {\n    border: none;\n}\n.listEditCon .el-button + .el-button {\n    margin-left: 25px;\n}\n.listEditCon .el-radio {\n    color: #999;\n}\n.listEditCon .el-form-item__label, .listEditCon .el-form-item__content {\n    line-height: 32px;\n    font-size: 14px;\n    color: #555555;\n}\n.listEditCon .el-input__icon {\n    line-height: 32px;\n}\n.listEditCon .el-form-item {\n    margin-bottom: 20px;\n}\n.listEditCon .el-form-item:nth-child(8) {\n      margin-bottom: 60px;\n}\n.listEditCon .el-form-item:last-child {\n      margin-bottom: 0;\n}\n.listEditCon .el-form-item.is-success .el-input__inner, .listEditCon .el-form-item.is-success .el-textarea__inner {\n    border-color: #E6E6E8 !important;\n}\n.listEditCon .el-form-item.is-success .el-input__inner, .listEditCon .el-form-item.is-success .el-input__inner:focus, .listEditCon .el-form-item.is-success .el-textarea__inner, .listEditCon .el-form-item.is-success .el-textarea__inner:focus {\n    border-color: #E6E6E8 !important;\n}\n.listEditCon .el-button:active, .listEditCon .el-button:focus, .listEditCon .el-button:hover {\n    background: #a1a8c0 !important;\n    border: none !important;\n    color: #fff !important;\n}\n.listEditCon .el-button--primary:focus, .listEditCon .el-button--primary:hover, .listEditCon .el-button--primary.is-active, .listEditCon .el-button--primary:active {\n    background: #3846DC !important;\n    border: none !important;\n    color: #fff !important;\n}\n.listEditCon .el-input.is-active .el-input__inner, .listEditCon .el-input__inner:focus, .listEditCon .el-textarea__inner:focus {\n    border-color: #e6e6e8 !important;\n}\n.el-select-dropdown.is-multiple .el-select-dropdown__item.selected, .el-select-dropdown__item.selected {\n  color: #4B67D6 !important;\n}\n.ev-kitsList .el-form-item:nth-child(2) {\n  margin-bottom: 20px !important;\n}\n.ev-kitsList .el-form-item:nth-child(3) {\n  margin-bottom: 20px !important;\n}\n.ev-kitsList .el-form-item.is-error .el-input__inner, .ev-kitsList .el-form-item.is-error .el-input__inner:focus, .ev-kitsList .el-form-item.is-error .el-textarea__inner, .ev-kitsList .el-form-item.is-error .el-textarea__inner:focus, .ev-kitsList .el-message-box__input input.invalid, .ev-kitsList .el-message-box__input input.invalid:focus {\n  border-color: #f56c6c !important;\n}\n",""])},957:function(e,t,r){"use strict";r.r(t);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"listEditCon ev-kitsList"},[t._m(0),t._v(" "),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm listForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"锦囊名",prop:"name"}},[r("el-input",{staticClass:"listName",attrs:{placeholder:"请输入锦囊名"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"锦囊说明",prop:"detailDesc"}},[r("el-input",{staticClass:"listName",attrs:{placeholder:"请输入锦囊说明"},model:{value:t.ruleForm.detailDesc,callback:function(e){t.$set(t.ruleForm,"detailDesc",e)},expression:"ruleForm.detailDesc"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"所属专科",prop:"region"}},[r("el-select",{staticClass:"listName",attrs:{placeholder:"请选择所属专科"},model:{value:t.ruleForm.region,callback:function(e){t.$set(t.ruleForm,"region",e)},expression:"ruleForm.region"}},t._l(t.proListArr,function(e){return r("el-option",{key:e.id,attrs:{label:e.tagName,value:e.id}})}))],1),t._v(" "),r("el-form-item",{attrs:{label:"锦囊排序",prop:"rank"}},[r("el-input",{staticClass:"listName",attrs:{placeholder:"请输入锦囊排序号"},model:{value:t.ruleForm.rank,callback:function(e){t.$set(t.ruleForm,"rank",e)},expression:"ruleForm.rank"}})],1),t._v(" "),r("el-form-item",{staticClass:"ev-imgPk ev-imgUpload01",attrs:{label:"锦囊封面",prop:"coverImg"}},[r("upload-img",{ref:"imgPK01",staticClass:"ev-imgPk imgPK01",attrs:{formData:t.paramData01,imgData:t.imgData01},on:{imgpk:t.imgpk01}})],1),t._v(" "),r("el-form-item",{staticClass:"ev-imgPk ev-imgUpload02",attrs:{label:"锦囊分享图",prop:"shareImg"}},[r("upload-img",{ref:"imgPK02",staticClass:"ev-imgPk imgPK02",attrs:{formData:t.paramData02,imgData:t.imgData02},on:{imgpk:t.imgpk02}})],1),t._v(" "),r("el-form-item",{attrs:{label:"状态",prop:"resource"}},[r("el-radio-group",{model:{value:t.ruleForm.resource,callback:function(e){t.$set(t.ruleForm,"resource",e)},expression:"ruleForm.resource"}},[r("el-radio",{attrs:{label:"上架"}}),t._v(" "),r("el-radio",{attrs:{label:"下架"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"desc"}},[r("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.desc,callback:function(e){t.$set(t.ruleForm,"desc",e)},expression:"ruleForm.desc"}})],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")]),t._v(" "),r("el-button",{on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("返回")])],1)],1)],1)},n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"uploadContainer"},[r("div",{staticClass:"addImg",class:{hasImg:t.dafaultSrc}},[t.dafaultSrc?r("img",{attrs:{src:t.dafaultSrc},on:{mouseover:function(e){t.bigImgShow(t.dafaultSrc)}}}):t._e(),t._v(" "),t.dafaultSrc?t._e():r("i",{staticClass:"addImg"}),t._v(" "),t.dafaultSrc?r("i",{staticClass:"closeImg",on:{click:function(e){t.itemClose()}}},[t._v("×")]):t._e(),t._v(" "),t.dafaultSrc?t._e():r("input",{ref:"referenceUpload",staticClass:"ev-uploadImg",attrs:{type:"file",name:"file",accept:"image/jpeg,image/jpg,image/png"},on:{change:t.inputChange}})]),t._v(" "),t.bigImgDialogVisible?r("div",{staticClass:"ev-bigImg",on:{click:t.closeBigImg}},[r("img",{attrs:{src:t.bigImgPath}})]):t._e()])};n._withStripped=i._withStripped=!0;var a=r(69),o=r(59),s={props:["formData","imgData"],data:function(){return{dafaultSrc:this.imgData&&this.imgData.src||"",prevFile:"",fileSize:2097152,imgpk:{responsePk:"",deletId:""},bigImgPath:"",bigImgDialogVisible:!1}},computed:{imgSrc:function(){return this.imgData&&this.imgData.src}},watch:{imgSrc:function(){this.dafaultSrc=this.imgSrc}},methods:{closeBigImg:function(){this.bigImgDialogVisible=!1},bigImgShow:function(e){e&&(this.bigImgPath=e,this.bigImgDialogVisible=!0)},itemClose:function(){this.dafaultSrc="",this.imgpk.responsePk="",this.imgpk.deletId=this.imgData&&this.imgData.id||"",this.$emit("imgpk",this.imgpk)},inputChange:function(e){var t=this.$refs.referenceUpload.files[0];if(t){if(t.size>this.fileSize)return alert("上传失败，请上传不大于2M的图片！"),!1;if(!/(jpg)|(jpeg)|(png)$/i.test(t.type))return alert("格式不支持，请选择jpg、png、jpeg"),!1;this.prevFile=t,this.dafaultSrc=this.localURL(t),this.loading=this.$loading({lock:!0,text:"图片上传中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.compressImg(t)}else this.prevFile&&this.localURL(this.prevFile)},localURL:function(e){var t=null;return null!=window.createObjectURL?t=window.createObjectURL(e):null!=window.URL?t=window.URL.createObjectURL(e):null!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t},compressImg:function(t){var r=new FileReader,i=new Image,n=this;r.readAsDataURL(t),r.onload=function(e){i.src=e.target.result,t.size<n.fileSize&&(n.formData.extName=t.type.split("/")[1],n.formData.fileContent=r.result.split(",")[1],n.formData.isValid=0,n.formData.waterType=2,n.uploadAction(n.formData))}},uploadAction:function(t){var r=this;o.a.post(a.a.attachment.url,t).then(function(e){(e=e.data)&&e.responseObject&&e.responseObject.responseData&&e.responseObject.responseData.data_list?r.uploadSave(e.responseObject.responseData.data_list,t):(r.loading.close(),alert("上传失败"))})},uploadSave:function(e,t){var r=this,i={sendSiteId:25,brochureId:t.brochureId,questionId:t.questionId,answerId:t.answerId,categoryType:t.categoryType,isValid:0,attUrl:e.attUrl,attSize:e.attSize,attHeight:e.attHeight,attWidth:e.attWidth,attFormat:e.extName};o.a.post(a.a.saveAttachment.url,i).then(function(e){r.loading.close(),(e=e.data)&&e.responseObject.responsePk?(r.imgpk.responsePk=e.responseObject.responsePk,r.$emit("imgpk",r.imgpk)):alert("保存失败")})}}},l=(r(749),r(58)),c=Object(l.a)(s,n,[],!1,null,"7fb24538",null);c.options.__file="src/components/common/upload/uploadImg.vue";var d=c.exports,m=r(68),u=(r(72),{data:function(){var e=function(e,t,r){t&&100<m.default.getByteLen(t)?r(new Error("长度超过了100个字符")):r()};return{bId:"",id:"",coverImgSrc:"",shareImgSrc:"",coverImgSrcD:"",shareImgSrcD:"",paramData01:{brochureId:"",questionId:"",answerId:"",categoryType:1,visitSiteId:25},paramData02:{brochureId:"",questionId:"",answerId:"",categoryType:2,visitSiteId:25},imgData01:{src:"",id:""},imgData02:{src:"",id:""},proListArr:[],ruleForm:{name:"",detailDesc:"",rank:"",region:"",coverImg:"",shareImg:"",resource:"下架",desc:""},rules:{name:[{required:!0,message:"请输入锦囊名",trigger:"blur"},{validator:function(e,t,r){t&&30<m.default.getByteLen(t)?r(new Error("长度超过了30个字符")):r()}}],detailDesc:[{required:!1,message:"请输入锦囊说明",trigger:"blur"},{validator:e}],rank:[{validator:function(e,t,r){t?/^[1-9]\d*$/.test(t)?r():r(new Error("请输入正整数")):r()}},{required:!1,message:"请输入锦囊排序号",trigger:"blur"}],region:[{required:!1,message:"请选择所属专科"}],coverImg:[{required:!1,validator:function(e,t,r){if(e.required){var i=document.getElementsByClassName("imgPK01")[0],n=i?i.getElementsByClassName("hasImg")[0]:"",a=n?n.getElementsByTagName("img")[0]:"";i&&n&&a?r():r(new Error("请上传锦囊封面"))}else r()}}],shareImg:[{required:!1,validator:function(e,t,r){if(e.required){var i=document.getElementsByClassName("imgPK02")[0],n=i?i.getElementsByClassName("hasImg")[0]:"",a=n?n.getElementsByTagName("img")[0]:"";i&&n&&a?r():r(new Error("请上传锦囊分享图"))}else r()}}],desc:[{validator:e}]}}},components:{uploadImg:d},computed:{resChangeVal:function(){return"下架"==this.ruleForm.resource?1:2}},watch:{resChangeVal:function(){var e=this;1==e.resChangeVal?(e.rules.detailDesc[0].required=!1,e.rules.region[0].required=!1,e.rules.coverImg[0].required=!1,e.rules.shareImg[0].required=!1,e.rules.rank[1].required=!1):(e.rules.detailDesc[0].required=!0,e.rules.region[0].required=!0,e.rules.coverImg[0].required=!0,e.rules.shareImg[0].required=!0,e.rules.rank[1].required=!0)}},methods:{submitForm:function(e){var t=this;t.$refs[e].validate(function(e){if(!e)return!1;t.saveInfo()})},resetForm:function(e){if(this.$refs[e].resetFields(),window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},imgpk01:function(e){this.coverImgSrc=e.responsePk,this.coverImgSrcD=e.deletId,this.ruleForm.coverImg=!!e||""},imgpk02:function(e){this.shareImgSrc=e.responsePk,this.shareImgSrcD=e.deletId,this.ruleForm.shareImg=!!e||""},saveInfo:function(){var t=this,r=this;m.default.openLoading("加载中...");var e={brochureName:r.ruleForm.name,isValid:"上架"==r.ruleForm.resource?"1":"0"};r.ruleForm.detailDesc&&(e.brochureDesc=r.ruleForm.detailDesc),r.ruleForm.region&&(e.areasExpertiseId=r.ruleForm.region),r.ruleForm.rank&&(e.sortId=r.ruleForm.rank),r.ruleForm.desc&&(e.remark=r.ruleForm.desc),r.bId&&(e.brochureId=r.bId),r.id&&(e.id=r.id),(r.coverImgSrc||r.shareImgSrc)&&(r.coverImgSrc&&r.shareImgSrc?e.idList=r.coverImgSrc+","+r.shareImgSrc:r.coverImgSrc&&!r.shareImgSrc?e.idList=r.coverImgSrc:r.shareImgSrc&&!r.coverImgSrc&&(e.idList=r.shareImgSrc)),(r.coverImgSrcD||r.shareImgSrcD)&&(r.coverImgSrcD&&r.shareImgSrcD?e.delIdList=r.coverImgSrcD+","+r.shareImgSrcD:r.coverImgSrcD&&!r.shareImgSrcD?e.delIdList=r.coverImgSrcD:r.shareImgSrcD&&!r.coverImgSrcD&&(e.delIdList=r.shareImgSrcD)),Object(o.a)({method:a.a.saveBrochure.type,url:a.a.saveBrochure.url,data:e}).then(function(e){if(m.default.closeLoading(),e&&e.data&&e.data.responseObject.responseStatus){if(window.history.length<=1)return r.$router.push({path:"kitsList"}),!1;r.$router.go(-1)}else alert("保存失败请重试")}).catch(function(e){m.default.closeLoading(),t.$allin_confirm({title:"提示",content:"保存失败，请重试",type:"notice"})})},professList:function(){var t=this,r=this;Object(o.a)({method:a.a.professList.type,url:a.a.professList.url,params:{firstResult:0,maxResult:99,treeLevel:2,platformId:1,isValid:1}}).then(function(e){e&&m.default.hasResponseData(e.data)&&(r.proListArr=e.data.responseObject.responseData.data_list)}).catch(function(e){m.default.closeLoading(),t.$allin_confirm({title:"提示",content:"获取失败，请刷新重试",type:"notice"})})},getInfo:function(){var t=this,r=this;m.default.openLoading("加载中..."),Object(o.a)({method:a.a.kitsInfo.type,url:a.a.kitsInfo.url,params:{brochureId:r.bId}}).then(function(e){if(m.default.closeLoading(),e&&e.data&&m.default.hasResponseData(e.data)){var t=e.data.responseObject.responseData.dataList[0];r.ruleForm.name=t.brochureName,r.ruleForm.detailDesc=t.brochureDesc,r.ruleForm.region=t.areasExpertiseId,r.ruleForm.rank=t.sortId,r.ruleForm.resource=1==t.isValid?"上架":"下架",r.ruleForm.desc=t.remark,r.imgData01.src=t.picUrl,r.imgData01.id=t.picId,r.imgData02.src=t.shareUrl,r.imgData02.id=t.shareId,t.picUrl&&t.picId&&(r.ruleForm.coverImg=!0,r.coverImgSrc=t.picId),t.shareUrl&&t.shareId&&(r.ruleForm.shareImg=!0,r.shareImgSrc=t.shareId)}}).catch(function(e){m.default.closeLoading(),t.$allin_confirm({title:"提示",content:"获取失败，请刷新重试",type:"notice"})})}},mounted:function(){var e=this;e.professList(),this.$route.query.bId&&e.$route.query.id&&(e.bId=e.$route.query.bId,e.id=e.$route.query.id,e.paramData01.brochureId=e.bId,e.paramData02.brochureId=e.bId,e.getInfo())},destroyed:function(){document.onkeydown=null,m.default.goBack()}}),p=(r(751),Object(l.a)(u,i,[function(){var e=this.$createElement,t=this._self._c||e;return t("section",[t("h1",{staticClass:"editTitle"},[this._v("锦囊管理后台 > 锦囊编辑页")])])}],!1,null,null,null));p.options.__file="src/views/kitsList/kitsEdit.vue";t.default=p.exports}}]);