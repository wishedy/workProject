(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{629:function(t,a,e){var n=e(852);"string"==typeof n&&(n=[[t.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(156)(n,i);n.locals&&(t.exports=n.locals)},630:function(t,a,e){var n=e(854);"string"==typeof n&&(n=[[t.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(156)(n,i);n.locals&&(t.exports=n.locals)},851:function(t,a,e){"use strict";var n=e(629);e.n(n).a},852:function(t,a,e){(t.exports=e(155)(!1)).push([t.i,"\n.creat-main-contains[data-v-7053ed8d] {\n  width: 1200px;\n  margin: 20px auto;\n}\n.creat-main-contains textarea[data-v-7053ed8d] {\n    font-family: PingFangSC-Regular;\n}\n.creat-main-contains .from-container[data-v-7053ed8d] {\n    background: #fff;\n    padding: 20px;\n    box-sizing: border-box;\n}\n.creat-main-contains .code-title[data-v-7053ed8d] {\n    font-family: PingFangSC-Semibold;\n    font-size: 20px;\n    color: #222222;\n    letter-spacing: 0;\n    line-height: 20px;\n    margin: 32px 0 25px;\n}\n.creat-main-contains .el-input-width[data-v-7053ed8d] {\n    width: 360px;\n}\n.creat-main-contains .el-textarea-width[data-v-7053ed8d] {\n    width: 400px;\n}\n.creat-main-contains .input-before-tip[data-v-7053ed8d] {\n    display: inline-block;\n    vertical-align: middle;\n    margin-right: 10px;\n    color: #999;\n}\n.creat-main-contains .input-after-tip[data-v-7053ed8d] {\n    display: inline-block;\n    vertical-align: middle;\n    margin-left: 10px;\n    color: #999;\n}\n.creat-main-contains .el-input-name .el-input--suffix .el-input__inner[data-v-7053ed8d] {\n    padding-right: 40px;\n}\n.creat-main-contains .el-input-tip[data-v-7053ed8d] {\n    color: #000;\n}\n.creat-main-contains .code-tip[data-v-7053ed8d] {\n    width: 100%;\n    background: #DFEEF9;\n    border: 1px solid #49B6DA;\n    line-height: 40px;\n    padding-left: 5px;\n    margin-bottom: 20px;\n}\n.creat-main-contains .code-tip-edit ul li[data-v-7053ed8d] {\n    display: inline-block;\n    width: 300px;\n    margin-right: 80px;\n    margin-bottom: 40px;\n}\n.creat-main-contains .code-tip-edit ul li .box-card[data-v-7053ed8d] {\n      color: #999999;\n}\n.creat-main-contains .code-tip-edit ul li .box-card h3[data-v-7053ed8d] {\n        text-align: center;\n        font-size: 14px;\n}\n.creat-main-contains .code-tip-edit ul li .box-card div[data-v-7053ed8d] {\n        display: inline-block;\n        width: 100px;\n        margin-right: 25px;\n        text-align: center;\n}\n.creat-main-contains .code-tip-edit ul li .box-card div h5[data-v-7053ed8d] {\n          padding: 20px 0;\n          font-size: 14px;\n          font-weight: normal;\n}\n.creat-main-contains .code-tip-edit ul li .box-card div p[data-v-7053ed8d] {\n          color: #4B67D6;\n          font-weight: bolder;\n}\n.creat-main-contains .code-info-title[data-v-7053ed8d] {\n    margin-bottom: 20px;\n}\n.creat-main-contains .code-info-title .icon-bg[data-v-7053ed8d] {\n      background: #0687FF;\n      width: 3px;\n      display: inline-block;\n      vertical-align: middle;\n      height: 16px;\n      border-radius: 1px;\n      margin-right: 5px;\n}\n.creat-main-contains .code-info-title span[data-v-7053ed8d] {\n      display: inline-block;\n      vertical-align: middle;\n}\n.creat-main-contains .content-container[data-v-7053ed8d] {\n    background: #FAFCFE;\n    width: 400px;\n    position: relative;\n}\n.creat-main-contains .content-container .content-desc[data-v-7053ed8d], .creat-main-contains .content-container .content-title[data-v-7053ed8d] {\n      padding-left: 20px;\n      line-height: 40px;\n      display: inline-block;\n      vertical-align: middle;\n}\n.creat-main-contains .content-container .content-img[data-v-7053ed8d] {\n      vertical-align: middle;\n      width: 100px;\n      height: 40px;\n      margin-left: 20px;\n}\n.creat-main-contains .content-container .close-icon[data-v-7053ed8d] {\n      position: absolute;\n      top: 50%;\n      transform: translateY(-50%);\n      right: 20px;\n      font-size: 26px;\n      color: #999;\n      cursor: pointer;\n}\n",""])},853:function(t,a,e){"use strict";var n=e(630);e.n(n).a},854:function(t,a,e){(t.exports=e(155)(!1)).push([t.i,"\n.creat-main-contains textarea {\n  font-family: PingFangSC-Regular;\n}\n",""])},980:function(t,a,e){"use strict";e.r(a);var n=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("section",{staticClass:"creat-main-contains"},[e("h1",{staticClass:"code-title"},[a._v("优惠券/创建通用优惠券")]),a._v(" "),a.isEdit?a._e():e("section",{staticClass:"code-tip"},[a._m(0)]),a._v(" "),a.isEdit?e("section",{staticClass:"code-tip-edit"},[e("ul",[e("li",[e("el-card",{staticClass:"box-card"},[e("h3",[a._v("领取维度")]),a._v(" "),e("div",[e("h5",[a._v("未领取")]),a._v(" "),e("p",[a._v("30")])]),a._v(" "),e("div",[e("h5",[a._v("已领取")]),a._v(" "),e("p",[a._v("90")])])])],1),a._v(" "),e("li",[e("el-card",{staticClass:"box-card"},[e("h3",[a._v("使用维度")]),a._v(" "),e("div",[e("h5",[a._v("未领取")]),a._v(" "),e("p",[a._v("30")])]),a._v(" "),e("div",[e("h5",[a._v("已领取")]),a._v(" "),e("p",[a._v("90")])])])],1)])]):a._e(),a._v(" "),e("el-form",{ref:"couponForm",staticClass:"from-container",attrs:{model:a.formData,rules:a.rules,"label-position":"left","label-width":"110px"}},[e("h2",{staticClass:"code-info-title"},[e("i",{staticClass:"icon-bg"}),e("span",[a._v("基本信息")])]),a._v(" "),e("el-form-item",{attrs:{label:"优惠券名称",prop:"couponName"}},[e("el-input",{staticClass:"el-input-width el-input-name",attrs:{placeholder:"优惠劵名称，不超过20个汉字",maxlength:"20"},model:{value:a.formData.couponName,callback:function(t){a.$set(a.formData,"couponName",t)},expression:"formData.couponName"}},[e("i",{staticClass:"el-input-tip",attrs:{slot:"suffix"},slot:"suffix"},[a._v(a._s(a.formData.couponName.length)+"/20")])])],1),a._v(" "),e("el-form-item",{attrs:{label:"优惠券描述",prop:"displayName"}},[e("el-input",{staticClass:"el-textarea-width",attrs:{type:"textarea",disabled:a.isEdit,resize:"none",maxlength:"16",placeholder:"示例：唯医学院送您满200减60学员券"},model:{value:a.formData.displayName,callback:function(t){a.$set(a.formData,"displayName",t)},expression:"formData.displayName"}}),a._v(" "),e("p",{staticClass:"input-after-tip"},[a._v("展示在付费视频和课程页领取区域中，文案中涉及金额需与该优惠券金额保持一致，请谨慎操作")])],1),a._v(" "),e("el-form-item",{attrs:{label:"面额",prop:"couponDenomination"}},[e("el-input",{staticClass:"el-input-width",attrs:{placeholder:"请输入优惠券金额，仅限数字",max:"10000",disabled:a.isEdit},nativeOn:{input:function(t){a.limmitNumber("couponDenomination")}},model:{value:a.formData.couponDenomination,callback:function(t){a.$set(a.formData,"couponDenomination",t)},expression:"formData.couponDenomination"}}),a._v(" "),e("p",{staticClass:"input-after-tip"},[a._v("元    优惠券扣减金额，必须小于满额金额")])],1),a._v(" "),e("el-form-item",{attrs:{label:"发行量",prop:"publishCount"}},[e("el-input",{staticClass:"el-input-width",attrs:{placeholder:"请输入发行量，仅限数字",max:"10000",disabled:a.isEdit},nativeOn:{input:function(t){a.limmitNumber("publishCount",1e4)}},model:{value:a.formData.publishCount,callback:function(t){a.$set(a.formData,"publishCount",t)},expression:"formData.publishCount"}}),a._v(" "),e("p",{staticClass:"input-after-tip"},[a._v("个    每批次仅限最多申请10000个，可分批申请")])],1),a._v(" "),e("el-form-item",{attrs:{label:"总额",prop:"couponTotal"}},[e("el-input",{staticClass:"el-input-width",attrs:{placeholder:"系统自动计算，总额 = 面额 * 发行量",max:"10000",disabled:!0},model:{value:a.formData.couponTotal,callback:function(t){a.$set(a.formData,"couponTotal",t)},expression:"formData.couponTotal"}}),a._v(" "),e("p",{staticClass:"input-after-tip"},[a._v("元")])],1),a._v(" "),e("el-form-item",{attrs:{label:"使用条件",prop:"useCondition"}},[e("p",{staticClass:"input-before-tip"},[a._v("满")]),a._v(" "),e("el-input",{staticClass:"el-input-width",attrs:{placeholder:"请输入满额金额，仅限数字",max:"10000",disabled:a.isEdit},nativeOn:{input:function(t){a.limmitNumber("useCondition")}},model:{value:a.formData.useCondition,callback:function(t){a.$set(a.formData,"useCondition",t)},expression:"formData.useCondition"}}),a._v(" "),e("p",{staticClass:"input-after-tip"},[a._v("元使用    必须大于优惠券面额")])],1),a._v(" "),e("el-form-item",{attrs:{label:"有效时间",required:""}},[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{prop:"validTime"}},[e("el-date-picker",{attrs:{type:"daterange",align:"right","start-placeholder":"开始时间","end-placeholder":"结束时间","range-separator":"到","value-format":"yyyy-MM-dd","default-time":["00:00:00","23:59:59"],"default-value":a.defaultValue,disabled:a.isEdit,"picker-options":a.pickerOptions},model:{value:a.formData.validTime,callback:function(t){a.$set(a.formData,"validTime",t)},expression:"formData.validTime"}})],1)],1),a._v(" "),e("p",{staticClass:"input-after-tip"},[a._v("开始时间不得晚于结束时间，开始前买家可以领取但不能使用")])],1),a._v(" "),e("el-form-item",{attrs:{label:"每人限领",prop:"perLimit"}},[e("el-input",{staticClass:"el-input-width",attrs:{disabled:!0},model:{value:a.formData.perLimit,callback:function(t){a.$set(a.formData,"perLimit",t)},expression:"formData.perLimit"}}),a._v(" "),e("p",{staticClass:"input-after-tip"},[a._v("张")])],1),a._v(" "),e("h2",{staticClass:"code-info-title"},[e("i",{staticClass:"icon-bg"}),e("span",[a._v("申请信息")])]),a._v(" "),e("el-form-item",{attrs:{label:"申请部门",prop:"applyDepartment"}},[e("el-select",{attrs:{placeholder:"请选择",disabled:a.isEdit},model:{value:a.formData.applyDepartment,callback:function(t){a.$set(a.formData,"applyDepartment",t)},expression:"formData.applyDepartment"}},[e("el-option",{attrs:{label:"市场运营部",value:0}}),a._v(" "),e("el-option",{attrs:{label:"商务部",value:1}}),a._v(" "),e("el-option",{attrs:{label:"协会事业部",value:2}}),a._v(" "),e("el-option",{attrs:{label:"测试部",value:3}}),a._v(" "),e("el-option",{attrs:{label:"产品部",value:4}})],1)],1),a._v(" "),e("el-form-item",{attrs:{label:"申请人",prop:"applyUser"}},[e("el-input",{staticClass:"el-input-width",attrs:{placeholder:"请输入申请人姓名",maxlength:"5",disabled:a.isEdit},model:{value:a.formData.applyUser,callback:function(t){a.$set(a.formData,"applyUser",t)},expression:"formData.applyUser"}})],1),a._v(" "),e("el-form-item",{attrs:{label:"申请用途",prop:"applyPurpose"}},[e("el-select",{attrs:{placeholder:"请选择",disabled:a.isEdit},model:{value:a.formData.applyPurpose,callback:function(t){a.$set(a.formData,"applyPurpose",t)},expression:"formData.applyPurpose"}},[e("el-option",{attrs:{label:"渠道合作",value:0}}),a._v(" "),e("el-option",{attrs:{label:"营销推广",value:2}}),a._v(" "),e("el-option",{attrs:{label:"内部测试",value:3}})],1)],1),a._v(" "),e("el-form-item",{attrs:{label:"用途描述"}},[e("el-input",{staticClass:"el-textarea-width",attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},resize:"none",maxlength:"100",placeholder:"请输入用途描述",disabled:a.isEdit},model:{value:a.formData.applyNote,callback:function(t){a.$set(a.formData,"applyNote",t)},expression:"formData.applyNote"}})],1),a._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:a.submitBtnOnClick}},[a._v("提交")])],1)],1)],1)};n._withStripped=!0;var i=e(69),o=e(59),r=e(68),l={name:"generalCouponDetail",data:function(){var e=this;return{isEdit:!1,id:"",formData:{couponName:"",displayName:"",couponDenomination:"",publishCount:"",couponTotal:"",useCondition:"",validTime:[new Date,new Date("")],perLimit:1,applyDepartment:"",applyUser:"",applyPurpose:"",applyNote:"",couponType:0},rules:{couponName:[{required:!0,message:"请输入优惠券名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],displayName:[{required:!0,message:"请输入优惠券描述",trigger:"blur"},{min:1,max:16,message:"长度在 1 到 16 个字符",trigger:"blur"}],couponDenomination:[{required:!0,message:"请输入优惠券金额",trigger:"blur"}],publishCount:[{required:!0,message:"请输入发行量",trigger:"blur"}],couponTotal:[{required:!0,message:"系统自动计算，总额 = 面额 * 发行量"}],useCondition:[{required:!0,message:"请输入满额金额",trigger:"blur"}],validTime:[{required:!0,message:"请选择有效时间",trigger:"change"},{required:!0,validator:function(t,a,e){return a?"Invalid Date"===a[1].toString()?e(new Error("请选择日期")):void e():e(new Error("请选择日期"))},trigger:"change"}],perLimit:[{required:!0}],applyDepartment:[{required:!0,message:"请选择申请部门",trigger:"change"}],applyUser:[{required:!0,message:"请输入申请人",trigger:"blur"}],applyPurpose:[{required:!0,message:"请选择申请用途",trigger:"change"}],applyNote:[{required:!1,message:""}]},pickerOptions:{disabledDate:function(t){var a=e.dateChange(new Date)+" 00:00:00";return t.getTime()<new Date(a).getTime()}},defaultValue:this.dateChange(new Date)}},methods:{getDetailData:function(){var e=this;r.default.openLoading("加载中..."),Object(o.a)({method:i.a.getCouponById.type,url:i.a.getCouponById.url,params:{id:this.id}}).then(function(t){if(r.default.closeLoading(),t&&t.data&&t.data.responseObject&&t.data.responseObject.responseData){var a=t.data.responseObject.responseData;e.formData.couponName=a.couponName,e.formData.displayName=a.displayName,e.formData.couponDenomination=a.couponDenomination,e.formData.publishCount=a.publishCount,e.formData.couponTotal=a.couponDenomination*a.publishCount,e.formData.useCondition=a.useCondition,e.formData.validTime=[new Date(a.startTime),new Date(a.endTime)],e.formData.perLimit=a.perLimit,e.formData.applyDepartment=a.applyDepartment,e.formData.applyUser=a.applyUser,e.formData.applyPurpose=a.applyPurpose,e.formData.applyNote=a.applyNote}else e.$allin_confirm({title:"提示",content:"查询失败",type:"notice"})}).catch(function(t){r.default.closeLoading(),e.$allin_confirm({title:"提示",content:"查询失败",type:"notice"})})},saveDetailData:function(){var e=this;parseInt(this.formData.useCondition)<=parseInt(this.formData.couponDenomination)?this.$allin_confirm({title:"提示",content:"优惠券扣减金额，必须小于满额金额，请重新输入面额金额！",type:"notice",done:function(){e.formData.useCondition=""},cancel:function(){e.formData.useCondition=""}}):this.isEdit?(r.default.openLoading("加载中..."),Object(o.a)({url:i.a.updateCouponNameById.url,type:i.a.updateCouponNameById.type,data:{id:this.id,couponName:this.formData.couponName}}).then(function(t){r.default.closeLoading(),t&&t.data&&t.data.responseObject&&t.data.responseObject.responseStatus?(e.$message("修改优惠券名称成功",{duration:2e3}),e.$router.push("/couponBatchList")):e.$message("修改优惠券名称失败",{duration:2e3})}).catch(function(t){r.default.closeLoading(),e.$message("修改优惠券名称失败",{duration:2e3})})):this.$allin_confirm({title:"提示",content:"优惠券生成后，主要字段信息不得修改，是否确认生成？",done:function(){r.default.openLoading("加载中...");var t={};for(var a in t.startTime=e.formData.validTime[0],t.endTime=e.formData.validTime[1],e.formData)(e.formData[a]||0===e.formData[a])&&(t[a]=e.formData[a]);t.opUser=localStorage.getItem("userLoginName"),delete t.validTime,Object(o.a)({method:i.a.createCoupon.type,url:i.a.createCoupon.url,data:t}).then(function(t){r.default.closeLoading(),t&&t.data&&t.data.responseObject&&t.data.responseObject.responseStatus?(e.$message("生成优惠券成功",{duration:2e3}),e.$router.push("/couponBatchList")):e.$allin_confirm({title:"提示",content:"生成优惠券失败",type:"notice"})}).catch(function(t){r.default.closeLoading(),e.$allin_confirm({title:"提示",content:"生成优惠券失败",type:"notice"})})}})},limmitNumber:function(t,a){var e=this;e.$nextTick(function(){null!==e.formData[t]&&""!==e.formData[t]&&(e.formData[t]=e.formData[t].replace(/[^\d]/g,""),a&&e.formData[t]>a&&(e.formData[t]=a))}),("couponDenomination"===t&&this.formData.publishCount||"publishCount"===t&&this.formData.couponDenomination)&&(this.formData.couponTotal=this.formData.publishCount*this.formData.couponDenomination)},dateChange:function(t){var a=t.getFullYear(),e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0"+e),n<10&&(n="0"+n),a+"-"+e+"-"+n},submitBtnOnClick:function(){var a=this;this.$refs.couponForm.validate(function(t){if(!t)return!1;a.saveDetailData()})}},created:function(){this.$route.query.id&&(this.isEdit=!0,this.id=this.$route.query.id),window.onbeforeunload=function(){return"离开此网站，系统可能不会保存您所做的更改。"}},mounted:function(){this.isEdit&&this.getDetailData()},destroyed:function(){window.onbeforeunload=null}},s=(e(851),e(853),e(58)),p=Object(s.a)(l,n,[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("p",[t._v("提示："),e("br"),t._v("\n      1、创建成功后，仅限修改“优惠券名称”字段；"),e("br"),t._v("\n      2、精品课商品优惠券仅限满额条件为798元，面额可配置100、150、210、250四个档位；"),e("br"),t._v("\n      3、知识星球商品优惠券仅限满额条件为1998元，面额可设置700、500、400、350四个档位。\n    ")])}],!1,null,"7053ed8d",null);p.options.__file="src/views/couponManager/generalCouponDetail.vue";a.default=p.exports}}]);