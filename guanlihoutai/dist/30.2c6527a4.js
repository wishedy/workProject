(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{523:function(t,e,a){var i=a(534);"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};a(156)(i,n);i.locals&&(t.exports=i.locals)},527:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"column-img-upload"},[a("div",{staticClass:"column-img-upload-container",on:{click:t.uploadImgOnClick}},[t.prevImgUrl?t._e():a("span",{staticClass:"column-img-upload-icon"}),t._v(" "),t.prevImgUrl?a("img",{attrs:{src:t.prevImgUrl}}):t._e(),t._v(" "),a("input",{ref:"column_img_upload_upload",attrs:{type:"file"},on:{change:t.fileChangeHandle}}),t._v(" "),t.uneditable?a("div",{staticClass:"uneditable"}):t._e()]),t._v(" "),t._t("default")],2)};i._withStripped=!0;var n=a(69),o=a(59),l=a(68),r={name:"columnImgUpload",props:{imgUrl:{type:String,require:!0},needClear:{type:Boolean,default:!1},imgFileSizeMaxLimit:{type:Number,require:!1},widthHeightMaxLimit:{type:Array,require:!1},widthHeightMinLimit:{type:Array,require:!1},uneditable:{type:Boolean,default:!1}},data:function(){return{fileData:{},widthHeightCheck:!0,prevImgUrl:this.imgUrl?this.imgUrl:""}},watch:{imgUrl:function(){this.prevImgUrl=this.imgUrl},needClear:function(t){t&&this.clearInput()}},methods:{uploadImgOnClick:function(){return!this.uneditable&&(!this.isLoading&&void this.$refs.column_img_upload_upload.click())},clearInput:function(){this.$refs.column_img_upload_upload.value=null,this.prevImgUrl=""},fileChangeHandle:function(t){var e=this,i=this,n=t.target.files[0];if(!n)return!1;if(!this.formatCheck(n))return this.$refs.column_img_upload_upload.value=null,!1;this.fileData.extName=n.type,this.fileData.file=n;var o=new FileReader;o.onload=function(t){if(e.fileData.fileContent=o.result,e.widthHeightMaxLimit||e.widthHeightMinLimit){var a=new Image;a.src=URL.createObjectURL(n),a.onload=function(){var t=a.width,e=a.height;i.widthHeightCheck=!0,i.widthHeightMaxLimit?t>i.widthHeightMaxLimit[0]?(i.$message.error("上传图片宽度不能超过"+i.widthHeightMaxLimit[0]+"px"),i.widthHeightCheck=!1):e>i.widthHeightMaxLimit[1]&&(i.$message.error("上传图片高度不能超过"+i.widthHeightMaxLimit[1]+"px"),i.widthHeightCheck=!1):i.widthHeightMinLimit&&(t<i.widthHeightMinLimit[0]?(i.$message.error("上传图片宽度不能小于"+i.widthHeightMinLimit[0]+"px"),i.widthHeightCheck=!1):e<i.widthHeightMinLimit[1]&&(i.$message.error("上传图片高度不能小于"+i.widthHeightMinLimit[1]+"px"),i.widthHeightCheck=!1)),i.widthHeightCheck?i.uploadImg():i.$refs.column_img_upload_upload.value=null}}else i.uploadImg()},o.readAsDataURL(n)},formatCheck:function(t){var e=5,a="image/jpeg"===t.type||"image/jpg"===t.type||"image/png"===t.type;this.imgFileSizeMaxLimit&&(e=this.imgFileSizeMaxLimit);var i=t.size/1024/1024<e;return a?!!i||(this.$message.error("上传图片大小不超过"+e+"M"),!1):(this.$message.error("上传图片仅支持JPG/JPEG/PNG格式"),!1)},uploadImg:function(){var i=this,t={fileContent:this.fileData.fileContent.split(",")[1],watermark:1,extName:this.fileData.extName.split("/")[1]};l.default.openLoading("图片上传中..."),Object(o.a)({method:n.a.uploadImg.type,url:n.a.uploadImg.url,data:t}).then(function(t){if(t&&t.data.responseObject&&!0===t.data.responseObject.responseStatus){l.default.closeLoading();var e=t.data.responseObject.responseData.data_list,a={};a.attUrl=e.attUrl,a.attFormat=e.extName,a.navigationAttType=1,a.attSize=e.attSize,a.attHeight=e.attHeight,a.attWidth=e.attWidth,a.attType=e.attType,i.prevImgUrl=URL.createObjectURL(i.fileData.file),i.$emit("uploadSuccess",a)}else l.default.closeLoading(),i.$message.error("图片上传失败！"),i.clearInput()}).catch(function(){l.default.closeLoading(),i.$message.error("图片上传失败！"),i.clearInput()})}},destroyed:function(){l.default.goBack()}},s=(a(533),a(58)),m=Object(s.a)(r,i,[],!1,null,"428cfd07",null);m.options.__file="src/views/columnManager/components/ColumnImgUpload.vue";e.a=m.exports},533:function(t,e,a){"use strict";var i=a(523);a.n(i).a},534:function(t,e,a){(t.exports=a(155)(!1)).push([t.i,'\n.column-img-upload-container[data-v-428cfd07] {\n  width: 150px;\n  height: 100px;\n  background: #EDF1FF;\n  position: relative;\n}\n.column-img-upload-container .uneditable[data-v-428cfd07] {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 150px;\n    height: 100px;\n    background: rgba(0, 0, 0, 0.2);\n    z-index: 5;\n}\n.column-img-upload-container .column-img-upload-icon[data-v-428cfd07] {\n    width: 38px;\n    height: 31px;\n    background: url("/static/images/upload/addImg.png") no-repeat;\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translateX(-50%) translateY(-50%);\n}\n.column-img-upload-container img[data-v-428cfd07] {\n    width: 100%;\n    height: 100%;\n}\n.column-img-upload-container input[data-v-428cfd07] {\n    display: none;\n}\n',""])},575:function(t,e,a){var i=a(746);"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};a(156)(i,n);i.locals&&(t.exports=i.locals)},745:function(t,e,a){"use strict";var i=a(575);a.n(i).a},746:function(t,e,a){(t.exports=a(155)(!1)).push([t.i,'\n@charset "UTF-8";\n/* 栏目后台页通用列表样式*/\n.column-manager-main-container {\n  width: 1200px;\n  margin: 0 auto;\n  background: #F6F7FA;\n  margin-top: 32px;\n}\n.column-manager-main-container h3 {\n    ont-family: PingFangSC-Semibold;\n    font-size: 20px;\n    color: #2C343A;\n    letter-spacing: 0;\n    line-height: 20px;\n    margin-bottom: 25px;\n}\n.column-manager-main-container .column-manager-search-area {\n    padding: 25px 0 0;\n    background: #ffffff;\n    box-shadow: 0 4px 10px 0 rgba(42, 53, 102, 0.04);\n    border-radius: 4px;\n    margin-bottom: 30px;\n}\n.column-manager-main-container .column-manager-search-area .el-input .el-input__inner {\n      background: #F7F9FC;\n      border: 1px solid #E6E6E8;\n      border-radius: 4px;\n}\n.column-manager-main-container .column-manager-search-area .column-search-submit button:nth-of-type(1) {\n      border: none;\n}\n.column-manager-main-container .column-manager-search-area .column-search-submit button:nth-of-type(2) {\n      color: #4B67D6;\n      border: 1px solid #4B67D6;\n      border-radius: 4px;\n}\n.column-manager-main-container .column-manager-button {\n    margin-bottom: 30px;\n}\n.column-manager-main-container .column-manager-button button {\n      color: #4B67D6;\n      border: 1px solid #4B67D6;\n      border-radius: 3px;\n}\n.column-manager-main-container .column-manager-button button span {\n        padding-right: 2px;\n}\n.column-manager-main-container .column-manager-table {\n    margin-bottom: 30px;\n}\n.column-manager-main-container .column-manager-table .el-table .cell {\n      font-family: PingFangSC-Regular;\n      font-size: 14px;\n      color: #333333;\n      letter-spacing: 0;\n      line-height: 1.5;\n}\n.column-manager-main-container .column-manager-table th.is-leaf {\n      font-weight: bold;\n}\n.column-manager-main-container .column-manager-table button {\n      width: 74px;\n      height: 28px;\n      padding: 0;\n      border: 1px solid #4B67D6;\n      border-radius: 3px;\n      font-family: PingFangSC-Regular;\n      font-size: 13px;\n      color: #4B67D6;\n      letter-spacing: 0;\n}\n.column-manager-main-container .column-manager-table button.changeState {\n        background: #EDF1FF;\n        border: 1px solid #4B67D6;\n        border-radius: 3px;\n        font-family: PingFangSC-Regular;\n        color: #4B67D6;\n        font-size: 13px;\n        letter-spacing: 0;\n        line-height: 1.2;\n}\n.column-manager-main-container .column-manager-table button.changeState.remove {\n          background: #FFEBE3;\n          border: 1px solid #FF7E4D;\n          color: #FF7E4D;\n}\n.column-manager-main-container .column-manager-table .column-table-index-btn {\n      background: #4B67D6;\n      border-radius: 3px;\n      font-family: PingFangSC-Regular;\n      font-size: 13px;\n      color: #FFFFFF;\n      letter-spacing: 0;\n      line-height: 13px;\n}\n.column-manager-main-container .column-manager-pagination {\n    float: right;\n}\n.source-list .cell {\n  font-family: PingFangSC-Regular,Arial, "Helvetica Neue", Helvetica, sans-serif;\n  font-size: 14px;\n  color: #333333;\n  letter-spacing: 0;\n  line-height: 1.2;\n}\n.source-list .headerClass {\n  text-align: center;\n}\n.submitBtn button:nth-of-type(1) {\n  border: none;\n}\n.submitBtn button:nth-of-type(2) {\n  color: #4B67D6;\n  border: 1px solid #4B67D6;\n  border-radius: 4px;\n}\n.uploadCon {\n  position: relative;\n}\n.uploadCon .deleteImg {\n    position: absolute;\n    top: -15px;\n    left: 140px;\n}\n.uploadCon .deleteImg i {\n      color: red;\n      font-size: 20px;\n      width: 25px;\n      height: 25px;\n}\n.tableBigImgDialog {\n  padding: 68px 0;\n  font-size: 0;\n  width: 376px;\n  height: 376px;\n  box-sizing: border-box;\n  background: #000000;\n  box-shadow: 0 5px 16px 0 rgba(20, 38, 95, 0.27);\n  border-radius: 3px;\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  margin: -188px 0 0 -188px;\n}\n.tableBigImgDialog img {\n    width: 100%;\n    height: 100%;\n    vertical-align: top;\n}\n',""])},979:function(t,e,a){"use strict";a.r(e);var i=function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("section",{staticClass:"column-manager-main-container"},[i("h3",[a._v("骨人云活动后台")]),a._v(" "),i("section",{staticClass:"column-manager-search-area"},[i("el-form",{ref:"activitySearchForm",attrs:{"label-width":"120px"},on:{keydown:function(t){return"button"in t||!a._k(t.keyCode,"enter",13,t.key,"Enter")?a.getTableData(t):null}}},[i("el-row",[i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"骨人云活动Id："}},[i("el-input",{attrs:{placeholder:"输入活动id"},model:{value:a.form.movementActivityId,callback:function(t){a.$set(a.form,"movementActivityId",t)},expression:"form.movementActivityId"}})],1)],1),a._v(" "),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"骨人云活动名称：","label-width":"140px"}},[i("el-input",{attrs:{placeholder:"输入活动名称"},model:{value:a.form.movementActivityName,callback:function(t){a.$set(a.form,"movementActivityName",t)},expression:"form.movementActivityName"}})],1)],1),a._v(" "),i("el-col",{attrs:{span:9}},[i("el-form-item",{attrs:{label:"发布时间："}},[i("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"不限","end-placeholder":"不限","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:a.form.publishTime,callback:function(t){a.$set(a.form,"publishTime",t)},expression:"form.publishTime"}})],1)],1),a._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"Banner图前端状态：","label-width":"160px"}},[i("el-select",{attrs:{placeholder:"请选择处理状态",required:"",value:""},model:{value:a.form.isShowBanner,callback:function(t){a.$set(a.form,"isShowBanner",t)},expression:"form.isShowBanner"}},[i("el-option",{attrs:{label:"不限",value:""}}),a._v(" "),i("el-option",{attrs:{label:"展示",value:"1"}}),a._v(" "),i("el-option",{attrs:{label:"不展示",value:"0"}})],1)],1)],1),a._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"活动状态："}},[i("el-select",{attrs:{placeholder:"请选择处理状态",required:"",value:""},model:{value:a.form.isValid,callback:function(t){a.$set(a.form,"isValid",t)},expression:"form.isValid"}},[i("el-option",{attrs:{label:"不限",value:""}}),a._v(" "),i("el-option",{attrs:{label:"已上架",value:"1"}}),a._v(" "),i("el-option",{attrs:{label:"已下架",value:"0"}})],1)],1)],1),a._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"参与数："}},[i("el-select",{attrs:{placeholder:"请选择处理状态",required:"",value:""},model:{value:a.form.movementNum,callback:function(t){a.$set(a.form,"movementNum",t)},expression:"form.movementNum"}},[i("el-option",{attrs:{label:"不限",value:""}}),a._v(" "),i("el-option",{attrs:{label:"0",value:[0,0]}}),a._v(" "),i("el-option",{attrs:{label:"1-10",value:[1,10]}}),a._v(" "),i("el-option",{attrs:{label:"11-20",value:[11,20]}}),a._v(" "),i("el-option",{attrs:{label:"21-30",value:[21,30]}}),a._v(" "),i("el-option",{attrs:{label:"31-40",value:[31,40]}}),a._v(" "),i("el-option",{attrs:{label:"41-50",value:[41,50]}}),a._v(" "),i("el-option",{attrs:{label:"50以上",value:[50]}})],1)],1)],1),a._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:"浏览数："}},[i("el-select",{attrs:{placeholder:"请选择处理状态",required:"",value:""},model:{value:a.form.browseNum,callback:function(t){a.$set(a.form,"browseNum",t)},expression:"form.browseNum"}},[i("el-option",{attrs:{label:"不限",value:""}}),a._v(" "),i("el-option",{attrs:{label:"0",value:[0,0]}}),a._v(" "),i("el-option",{attrs:{label:"1-50",value:[1,50]}}),a._v(" "),i("el-option",{attrs:{label:"51-200",value:[51,200]}}),a._v(" "),i("el-option",{attrs:{label:"201-500",value:[201,500]}}),a._v(" "),i("el-option",{attrs:{label:"501-1千",value:[501,1e3]}}),a._v(" "),i("el-option",{attrs:{label:"1千以上",value:[1e3]}})],1)],1)],1)],1),a._v(" "),i("el-row",[i("el-col",[i("el-form-item",{staticClass:"submitBtn",staticStyle:{float:"right","margin-right":"50px"}},[i("el-button",{on:{click:a.resetForm}},[a._v("清空条件")]),a._v(" "),i("el-button",{on:{click:a.onSubmit}},[a._v("筛选")])],1)],1)],1)],1)],1),a._v(" "),i("section",{staticClass:"column-manager-button"},[i("el-row",[i("el-col",[i("el-button",{on:{click:a.addActivity}},[i("span",{staticClass:"el-icon-circle-plus"}),a._v("新增活动")])],1)],1)],1),a._v(" "),i("section",{staticClass:"source-list column-manager-table"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:a.tableData,fit:!0,"row-class-name":a.tableRowClassName},on:{"sort-change":a.tableChange}},[i("el-table-column",{attrs:{prop:"movementActivityId",label:"骨人云活动id",width:"140",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"movementActivityName",label:"骨人云活动名称",width:"260",align:"left","header-align":"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"movementActivityUrl",label:"骨人云活动链接地址",width:"260",align:"left","header-align":"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"publishTime",label:"发布时间",align:"center",width:"160",formatter:a.formatterDate}}),a._v(" "),i("el-table-column",{attrs:{prop:"movementNum",label:"参与数",width:"120",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"browseNum",width:"100",label:"浏览数",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"attUrl",width:"120",label:"Banner图预览",align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.attUrl?i("img",{staticClass:"bigImgShow",attrs:{src:"/static/images/icons/icon-picture_hover_tiny.png",alt:""},on:{mouseenter:function(t){a.smallImgMouseenter(e.row.attUrl)},mouseleave:a.smallImgMouseLeave}}):a._e()]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"isShow",width:"140",label:"Banner图前端状态",align:"center",formatter:a.isShowFormatter}}),a._v(" "),i("el-table-column",{attrs:{prop:"isValid",width:"100",label:"活动状态",align:"center",formatter:a.isValidFormatter}}),a._v(" "),i("el-table-column",{attrs:{label:"操作",width:"220",fixed:"right",align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){return[i("el-button",{on:{click:function(t){a.editActivity(e.row)}},nativeOn:{keydown:function(t){t.preventDefault()}}},[a._v("编辑")]),a._v(" "),i("el-button",{class:0===parseInt(e.row.isValid)?"changeState":"changeState remove",on:{click:function(t){a.handleUpAndDown(e.row)}},nativeOn:{keydown:function(t){t.preventDefault()}}},[a._v("\n            "+a._s(0===parseInt(e.row.isValid)?"上架":"下架")+"\n          ")])]}}])})],1)],1),a._v(" "),i("el-row",{staticClass:"pagination",staticStyle:{margin:"20px 0"}},[i("el-col",{attrs:{span:10,offset:5}},[i("el-pagination",{attrs:{"current-page":a.currentPage,"page-sizes":[10,20,30,40],"page-size":a.pageSize,layout:"total,sizes, prev, pager, next, jumper",total:a.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)],1),a._v(" "),a.editDialogData.visible?i("el-dialog",{attrs:{title:a.editDialogData.title,visible:a.editDialogData.visible,width:"770px",top:"18vh","custom-class":"",center:!0,"lock-scroll":!1},on:{"update:visible":function(t){a.$set(a.editDialogData,"visible",t)}}},[i("el-form",{ref:"editDialogForm",attrs:{"label-width":"90px",model:a.editDialogData.rowData,rules:a.rules}},[i("el-row",[i("el-col",{attrs:{span:16}},[i("el-form-item",{attrs:{label:"骨人云活动名称",prop:"movementActivityName","label-width":"140px"}},[i("el-input",{attrs:{placeholder:"输入活动名称"},model:{value:a.editDialogData.rowData.movementActivityName,callback:function(t){a.$set(a.editDialogData.rowData,"movementActivityName",t)},expression:"editDialogData.rowData.movementActivityName"}})],1)],1)],1),a._v(" "),"edit"===a.editDialogData.action?i("el-row",[i("el-col",{attrs:{span:16}},[i("el-form-item",{attrs:{label:"骨人云活动Id",prop:"movementActivityId","label-width":"140px"}},[i("el-input",{attrs:{disabled:""},model:{value:a.editDialogData.rowData.movementActivityId,callback:function(t){a.$set(a.editDialogData.rowData,"movementActivityId",t)},expression:"editDialogData.rowData.movementActivityId"}})],1)],1)],1):a._e(),a._v(" "),i("el-row",[i("el-col",{attrs:{span:16}},[i("el-form-item",{attrs:{label:"活动链接地址",prop:"activityMobileUrl","label-width":"140px"}},[i("el-input",{attrs:{placeholder:"输入H5链接地址"},model:{value:a.editDialogData.rowData.movementActivityUrl,callback:function(t){a.$set(a.editDialogData.rowData,"movementActivityUrl",t)},expression:"editDialogData.rowData.movementActivityUrl"}})],1)],1)],1),a._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"column-course-img-list"},[i("el-form-item",{staticClass:"column-course-img-label img-upload",attrs:{label:"Banner图",prop:"attUrl","label-width":"140px"}},[i("div",{staticClass:"uploadCon"},[i("ColumnImgUpload",{attrs:{imgUrl:a.editDialogData.rowData.attUrl,imgFileSizeMaxLimit:2,widthHeightMaxLimit:[1035,216],needClear:a.needClear},on:{uploadSuccess:a.handleImgUploadSuccess}}),a._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:a.editDialogData.rowData.isUploaded,expression:"editDialogData.rowData.isUploaded"}],staticClass:"deleteImg",on:{click:a.handleDeleteImg}},[i("i",{staticClass:"el-icon-circle-close"})])],1)])],1)])],1),a._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"column-course-img-list"},[i("el-form-item",{staticClass:"column-course-img-label img-upload",attrs:{label:"Banner图前端状态",prop:"attUrl","label-width":"140px"}},[i("el-radio-group",{model:{value:a.editDialogData.rowData.isShow,callback:function(t){a.$set(a.editDialogData.rowData,"isShow",t)},expression:"editDialogData.rowData.isShow"}},[i("el-radio",{attrs:{label:"1"},nativeOn:{click:function(t){return t.preventDefault(),a.handleShowChange(t)}},model:{value:a.editDialogData.rowData.isShow,callback:function(t){a.$set(a.editDialogData.rowData,"isShow",t)},expression:"editDialogData.rowData.isShow"}},[a._v("展示")]),a._v(" "),i("el-radio",{attrs:{label:"0"},model:{value:a.editDialogData.rowData.isShow,callback:function(t){a.$set(a.editDialogData.rowData,"isShow",t)},expression:"editDialogData.rowData.isShow"}},[a._v("不展示")])],1)],1)],1)])],1),a._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{staticStyle:{float:"right"}},[i("el-button",{staticStyle:{width:"150px"},attrs:{type:"primary",size:"small"},on:{click:a.saveActivity}},[a._v("发布")])],1)],1)],1)],1)],1):a._e(),a._v(" "),a.bigImgDialogVisible?i("div",{staticClass:"tableBigImgDialog",on:{mouseenter:a.bigImgMouseenter,mouseleave:a.bigImgMouseLeave}},[i("img",{attrs:{src:a.bigImgPath,alt:""}})]):a._e()],1)};i._withStripped=!0;var n=a(105),o=a.n(n),r=a(59),s=a(69),m=a(68),l={name:"boneCloudActivityColumn",components:{ColumnImgUpload:a(527).a},data:function(){return{columnName:this.$route.query.columnName,columnId:this.$route.query.columnId,bigImgPath:"",bigImgDialogVisible:!1,bigImgTimer:null,needClear:!1,params:{movementActivityId:"",movementActivityName:"",startTime:"",endTime:"",isShowBanner:"",movementNumMin:"",movementNumMax:"",browseNumMin:"",browseNumMax:"",maxResult:10},form:{movementActivityId:"",movementActivityName:"",publishTime:"",isShowBanner:"",movementNum:"",browseNum:"",isValid:"",sortType:1},tableData:[],currentPage:1,pageSize:10,total:0,firstResult:0,editDialogData:{title:"新增活动",visible:!1,sortIdPlaceHolder:"",sortIdDisabled:"disabled",rowData:{movementActivityName:"",movementActivityId:"",imgUrl:"",activityMobileUrl:"",isValid:0,bannerId:"",isUploaded:!1,attList:[{attUrl:""}]}},rules:{movementActivityName:[{required:!0,message:"活动名称不能为空",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}]}}},watch:{},mounted:function(){var e=this;this.getTableData(),document.onkeydown=function(t){13===t.keyCode&&(e.editDialogData.visible||e.getTableData())}},destroyed:function(){document.onkeydown=null,m.default.goBack()},methods:{smallImgMouseenter:function(t){if(this.bigImgTimer&&clearTimeout(this.bigImgTimer),t){var e=t;e?e.includes("_c_t")?this.bigImgPath=e.substring(0,e.indexOf("_c_t"))+"_c"+e.substring(e.lastIndexOf("."),e.length):this.bigImgPath=e:this.bigImgPath="",this.bigImgDialogVisible=!0}},smallImgMouseLeave:function(){var t=this;t.bigImgTimer=setTimeout(function(){t.bigImgDialogVisible=!1},1e3)},bigImgMouseenter:function(){this.bigImgTimer&&clearTimeout(this.bigImgTimer)},bigImgMouseLeave:function(){this.bigImgDialogVisible=!1},getTableData:function(){var e=this,a=this,t={sortType:a.form.sortType,firstResult:a.firstResult,maxResult:a.params.maxResult};""!==a.form.movementActivityId&&(t.movementActivityId=a.form.movementActivityId),""!==a.form.movementActivityName&&(t.movementActivityName=a.form.movementActivityName),""!==a.form.isValid&&(t.isValid=a.form.isValid),""!==a.form.isShowBanner&&(t.isShowBanner=a.form.isShowBanner),a.form.publishTime&&(t.startTime=a.form.publishTime[0],t.endTime=a.form.publishTime[1]),a.form.browseNum&&(t.browseNumMin=a.form.browseNum[0],void 0!==a.form.browseNum[1]&&(t.browseNumMax=a.form.browseNum[1])),a.form.movementNum&&(t.movementNumMin=a.form.movementNum[0],void 0!==a.form.movementNum[1]&&(t.movementNumMax=a.form.movementNum[1])),m.default.openLoading("加载中..."),Object(r.a)({url:s.a.boneCloudBannerGetMapList.url,type:s.a.boneCloudBannerGetMapList.type,params:t}).then(function(t){m.default.closeLoading(),a.tableData=t.data.responseObject.responseData.dataList,a.total=t.data.responseObject.responseData.totalCount}).catch(function(t){m.default.closeLoading(),e.$message({type:"info",message:"查询失败"})})},resetForm:function(){this.$refs.activitySearchForm.resetFields(),this.form.movementActivityId="",this.form.movementActivityName="",this.form.publishTime="",this.form.isValid="",this.form.isShowBanner="",this.form.browseNum="",this.form.movementNum=""},tableRowClassName:function(t){var e=t.row,a=t.rowIndex;e.index=a+1},onSubmit:function(){Array.isArray(this.form.publishTime)&&0<this.form.publishTime.length?(this.form.startTime=this.form.publishTime[0],this.form.endTime=this.form.publishTime[1]):(this.form.startTime="",this.form.endTime=""),this.currentPage=1,this.firstResult=0,this.getTableData()},formatterDate:function(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];return e[2]?e[2].substring(0,e[2].length-5):""},handleImgUploadSuccess:function(t){var e=this;m.default.openLoading("保存中...");var a=o()({},t);a.movementActivityId="",a.isValid="0",a.isShow="0",e.needClear=!1,e.editDialogData.rowData.isUploaded=!0,e.$set(e.editDialogData.rowData,"isUploaded",!0),this.$forceUpdate(),Object(r.a)({method:s.a.boneCloudSavePic.type,url:s.a.boneCloudSavePic.url,data:a}).then(function(t){t.data.responseObject.responseStatus&&(e.editDialogData.rowData.bannerId=t.data.responseObject.responsePk),m.default.closeLoading()}).catch(function(){m.default.closeLoading(),this.$message("保存图片失败")})},handleSizeChange:function(t){this.params.maxResult=t,this.pageSize=t,this.firstResult=0,this.currentPage=0,this.getTableData()},handleCurrentChange:function(t){this.currentPage=t,this.firstResult=(t-1)*this.params.maxResult,this.getTableData()},isValidFormatter:function(t,e,a){var i="";switch(parseInt(t.isValid)){case 0:i="已下架";break;case 1:i="已上架";break;default:i=""}return i},isShowFormatter:function(t,e,a){var i="";switch(parseInt(t.isShow)){case 0:i="不展示";break;case 1:i="展示";break;default:i=""}return i},tableChange:function(t,e,a){this.currentPage=1,"updateTime"===t.prop?(this.params.sortType="ascending"===t.order?4:5,this.getTableData()):"sortId"===t.prop&&(this.params.sortType="ascending"===t.order?2:3,this.getTableData()),this.setQueryParamsInLocalStorage(this.params)},addActivity:function(){var t=this;t.$refs.editDialogForm&&t.$refs.editDialogForm.resetFields(),t.editDialogData.action="add",t.editDialogData.title="新增活动",t.editDialogData.visible=!0,t.editDialogData.attUrl="",t.editDialogData.sortIdDisabled=!0,t.editDialogData.rowData={movementActivityId:"",movementActivityName:"",isShowBanner:"",isUploaded:!1,bannerId:null,isShow:"0",movementActivityUrl:"",attUrl:""},t.editDialogData.rowData.userName=localStorage.getItem("userLoginName")},editActivity:function(t){var e=this;e.editDialogData.action="edit",e.editDialogData.title="编辑活动",e.editDialogData.visible=!0,e.editDialogData.rowData={movementActivityId:t.movementActivityId,movementActivityName:t.movementActivityName,isShowBanner:t.isShowBanner,isValid:t.isValid,isShow:t.isShow,movementActivityUrl:t.movementActivityUrl,bannerId:t.bannerId,attUrl:t.attUrl},t.attUrl&&(e.editDialogData.rowData.isUploaded=!0)},handleDeleteImg:function(){var t=this;t.editDialogData.rowData.bannerId="",t.editDialogData.rowData.attUrl="",t.editDialogData.rowData.isUploaded=!1,"1"===t.editDialogData.rowData.isShow&&(t.editDialogData.rowData.isShow="0"),t.needClear=!0,t.$forceUpdate()},handleUpAndDown:function(a){var i=this,n=this,t="",o="";o=1===parseInt(a.isValid)?(t="确定下架此骨人云活动么？","下架"):(t="确定上架此骨人云活动么","上架");var l=1===parseInt(a.isValid)?"0":"1";this.$allin_confirm({content:t,done:function(){Object(r.a)({method:s.a.boneCloudSaveActivity.type,url:s.a.boneCloudSaveActivity.url,data:{movementActivityId:a.movementActivityId,bannerId:a.bannerId,isValid:l,isShow:a.isShow,visitSiteId:25}}).then(function(t){if(t&&t.data&&t.data.responseObject){var e=t.data.responseObject;e.responseStatus?(i.$allin_confirm({title:"提示",content:o+"成功",type:"notice"}),a.isValid=l,n.getTableData()):i.$allin_confirm({title:"提示",content:o+"失败"+(e.responseMessage||failMsg),type:"notice"})}m.default.closeLoading()}).catch(function(t){m.default.closeLoading(),i.$message(o+"活动失败")})}})},handleShowChange:function(){var t=this;return t.editDialogData.rowData.bannerId?t.$allin_confirm({content:"确定在前台展示此Banner么？",type:"confirm",done:function(){t.editDialogData.rowData.isShow="1"}}):this.$message("请先添加Banner图"),!1},saveActivity:function(){var e=this;e.editDialogData.rowData.columnId=e.columnId,e.editDialogData.rowData.columnType="4";var a=o()({},this.editDialogData.rowData);a.userName=localStorage.getItem("userLoginName"),this.$refs.editDialogForm.validate(function(t){if(!t)return!1;m.default.openLoading("加载中..."),Object(r.a)({method:s.a.boneCloudSaveActivity.type,url:s.a.boneCloudSaveActivity.url,data:a}).then(function(t){m.default.closeLoading(),e.editDialogData.visible=!1,"add"===e.editDialogData.action?e.$allin_confirm({title:"提示",content:"新增成功",type:"notice"}):e.$allin_confirm({title:"提示",content:"更新成功",type:"notice"}),e.getTableData()}).catch(function(){m.default.closeLoading(),this.$message("新增活动失败")})})}}},c=(a(745),a(58)),d=Object(c.a)(l,i,[],!1,null,null,null);d.options.__file="src/views/columnManager/boneCloudBannerColumn.vue";e.default=d.exports}}]);