(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{636:function(e,t,a){var n=a(866);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(156)(n,i);n.locals&&(e.exports=n.locals)},637:function(e,t,a){var n=a(868);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(156)(n,i);n.locals&&(e.exports=n.locals)},865:function(e,t,a){"use strict";var n=a(636);a.n(n).a},866:function(e,t,a){(e.exports=a(155)(!1)).push([e.i,"\n.addContent .add-from .content-input {\n  width: 300px;\n  margin-left: 50px;\n}\n.addContent .search-button {\n  width: 100px;\n  height: 32px;\n  background: #3846dc;\n  border-radius: 3px;\n  line-height: 32px;\n  font-size: 14px;\n  font-weight: 500;\n  color: white;\n  margin-left: 30px;\n  cursor: pointer;\n  display: inline-block;\n  vertical-align: middle;\n  text-align: center;\n}\n.addContent .select-content {\n  margin: 20px 0;\n  padding-left: 50px;\n}\n.addContent .select-content .choosed-text {\n    display: inline-block;\n    width: 656px;\n}\n.addContent .select-content .choosed-text span {\n      width: 656px;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      -webkit-line-clamp: 1;\n      -webkit-box-orient: vertical;\n      white-space: nowrap;\n      display: inline-block;\n      vertical-align: middle;\n}\n",""])},867:function(e,t,a){"use strict";var n=a(637);a.n(n).a},868:function(e,t,a){(e.exports=a(155)(!1)).push([e.i,"\n.creat-main-contains {\n  width: 1200px;\n  margin: 20px auto;\n}\n.creat-main-contains .from-container {\n    background: #fff;\n    padding: 20px;\n    box-sizing: border-box;\n}\n.creat-main-contains .code-title {\n    font-family: PingFangSC-Semibold;\n    font-size: 20px;\n    color: #222222;\n    letter-spacing: 0;\n    line-height: 20px;\n    margin: 32px 0 25px;\n}\n.creat-main-contains .el-input-width {\n    width: 360px;\n}\n.creat-main-contains .el-textarea-width {\n    width: 400px;\n}\n.creat-main-contains .input-after-tip {\n    display: inline-block;\n    vertical-align: middle;\n    margin-left: 10px;\n    color: #999;\n}\n.creat-main-contains .el-input-name.el-input--suffix .el-input__inner {\n    padding-right: 40px;\n}\n.creat-main-contains .el-input-tip {\n    color: #000;\n}\n.creat-main-contains .code-tip {\n    width: 100%;\n    background: #DFEEF9;\n    border: 1px solid #49B6DA;\n    line-height: 40px;\n    padding-left: 5px;\n    margin-bottom: 20px;\n}\n.creat-main-contains .code-info-title {\n    margin-bottom: 20px;\n}\n.creat-main-contains .code-info-title .icon-bg {\n      background: #0687FF;\n      width: 3px;\n      display: inline-block;\n      vertical-align: middle;\n      height: 16px;\n      border-radius: 1px;\n      margin-right: 5px;\n}\n.creat-main-contains .code-info-title span {\n      display: inline-block;\n      vertical-align: middle;\n}\n.creat-main-contains .content-container {\n    background: #FAFCFE;\n    width: 400px;\n    position: relative;\n}\n.creat-main-contains .content-container .content-desc, .creat-main-contains .content-container .content-title {\n      padding-left: 20px;\n      line-height: 40px;\n      display: inline-block;\n      vertical-align: middle;\n}\n.creat-main-contains .content-container .content-img {\n      vertical-align: middle;\n      width: 100px;\n      height: 40px;\n      margin-left: 20px;\n}\n.creat-main-contains .content-container .close-icon {\n      position: absolute;\n      top: 50%;\n      transform: translateY(-50%);\n      right: 20px;\n      font-size: 26px;\n      color: #999;\n      cursor: pointer;\n}\n",""])},959:function(e,t,a){"use strict";a.r(t);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"creat-main-contains"},[a("h1",{staticClass:"code-title"},[t._v("兑换码/创建兑换码")]),t._v(" "),t._m(0),t._v(" "),a("el-form",{ref:"form",staticClass:"from-container",attrs:{model:t.form,"label-width":"110px",rules:t.rules}},[a("h2",{staticClass:"code-info-title"},[a("i",{staticClass:"icon-bg"}),a("span",[t._v("基本信息")])]),t._v(" "),a("el-form-item",{staticClass:"sdfadsf",attrs:{label:"兑换码名称",prop:"redeemCodeName"}},[a("el-input",{staticClass:"el-input-width el-input-name",attrs:{placeholder:"请输入兑换码名称，不超过20个字符",maxlength:"20"},nativeOn:{input:function(e){return t.limmitLength(e)}},model:{value:t.form.redeemCodeName,callback:function(e){t.$set(t.form,"redeemCodeName",e)},expression:"form.redeemCodeName"}},[a("i",{staticClass:"el-input-tip",attrs:{slot:"suffix"},slot:"suffix"},[t._v(t._s(t.form.redeemCodeName.length)+"/20")])])],1),t._v(" "),a("el-form-item",{attrs:{label:"发行量",prop:"publishCount"}},[a("el-input",{staticClass:"el-input-width",attrs:{placeholder:"请输入发行量，仅限输入数字",max:"10000",disabled:t.isDisabled},on:{blur:function(e){t.inputBlur("publishCount")}},nativeOn:{input:function(e){t.limmitNumber("publishCount",1e4,1)}},model:{value:t.form.publishCount,callback:function(e){t.$set(t.form,"publishCount",e)},expression:"form.publishCount"}}),t._v(" "),a("p",{staticClass:"input-after-tip"},[t._v("个    每批次仅限最多申请10000个，可分批申请")])],1),t._v(" "),a("el-form-item",{attrs:{label:"发行类型",prop:"publishType"}},[a("el-radio-group",{attrs:{disabled:t.isDisabled},model:{value:t.form.publishType,callback:function(e){t.$set(t.form,"publishType",e)},expression:"form.publishType"}},[a("el-radio",{attrs:{label:"0"}},[t._v("电子码")]),t._v(" "),a("el-radio",{attrs:{label:"1"}},[t._v("纸质码")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"有效时间",required:""}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"date1"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","start-placeholder":t.dateChange(new Date),"end-placeholder":"结束时间","range-separator":"到","unlink-panels":"","value-format":"yyyy-MM-dd","default-time":["00:00:00","23:59:59"],"default-value":t.defaultValue,disabled:t.isDisabled,"picker-options":t.pickerOptions},model:{value:t.form.date1,callback:function(e){t.$set(t.form,"date1",e)},expression:"form.date1"}})],1)],1),t._v(" "),a("p",{staticClass:"input-after-tip"},[t._v("开始时间不得晚于结束时间")])],1),t._v(" "),a("el-form-item",{staticClass:"addContent",attrs:{label:"兑换商品",prop:"productList"}},[t.form.productList?t._e():a("div",[a("el-button",{staticClass:"el-icon-plus",on:{click:function(e){t.showAdd=!0}}},[t._v("选择商品")]),t._v(" "),a("p",{staticClass:"input-after-tip"},[t._v("兑换码一旦创建，商品不得删除，请谨慎操作")])],1),t._v(" "),t.form.productList?a("div",{staticClass:"content-container"},[a("p",{staticClass:"content-desc"},[t._v("付费课程")]),t._v(" "),t.form.productList[0].picUrl?a("img",{staticClass:"content-img",attrs:{src:t.form.productList[0].picUrl}}):t._e(),t._v(" "),a("p",{staticClass:"content-title"},[t._v(t._s(t.form.productList[0].productName))]),t._v(" "),t.isDisabled?t._e():a("i",{staticClass:"close-icon",on:{click:t.closeContent}},[t._v("×")])]):t._e()]),t._v(" "),a("el-form-item",{attrs:{label:"商品价值",prop:"productPrice"}},[a("el-input",{staticClass:"el-input-width",attrs:{disabled:"disabled"},model:{value:t.form.productPrice,callback:function(e){t.$set(t.form,"productPrice",e)},expression:"form.productPrice"}}),t._v(" "),a("p",{staticClass:"input-after-tip"},[t._v("元")])],1),t._v(" "),a("el-form-item",{attrs:{label:"总额",prop:"total"}},[a("el-input",{staticClass:"el-input-width",attrs:{disabled:"disabled"},model:{value:t.form.total,callback:function(e){t.$set(t.form,"total",e)},expression:"form.total"}}),t._v(" "),a("p",{staticClass:"input-after-tip"},[t._v("元")])],1),t._v(" "),a("h2",{staticClass:"code-info-title"},[a("i",{staticClass:"icon-bg"}),a("span",[t._v("申请信息")])]),t._v(" "),a("el-form-item",{attrs:{label:"申请部门",prop:"applyDepartment"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:t.isDisabled},model:{value:t.form.applyDepartment,callback:function(e){t.$set(t.form,"applyDepartment",e)},expression:"form.applyDepartment"}},[a("el-option",{attrs:{label:"市场运营部",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"商务部",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"协会事业部",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"测试部",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"产品部",value:"4"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"申请人",prop:"applyUser"}},[a("el-input",{staticClass:"el-input-width",attrs:{placeholder:"请输入申请人姓名",maxlength:"5",disabled:t.isDisabled},model:{value:t.form.applyUser,callback:function(e){t.$set(t.form,"applyUser",e)},expression:"form.applyUser"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"申请用途",prop:"applyPurpose"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:t.isDisabled},model:{value:t.form.applyPurpose,callback:function(e){t.$set(t.form,"applyPurpose",e)},expression:"form.applyPurpose"}},[a("el-option",{attrs:{label:"厂商购买",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"院方采购",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"平台赠送",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"内部测试",value:"2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"用途描述"}},[a("el-input",{staticClass:"el-textarea-width",attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},resize:"none",maxlength:"100",placeholder:"请输入用途描述",disabled:t.isDisabled},model:{value:t.form.applyNote,callback:function(e){t.$set(t.form,"applyNote",e)},expression:"form.applyNote"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")])],1)],1),t._v(" "),t.showAdd?a("add-content",{on:{closeDalog:t.closeDalog,addContent:t.contentAdd}}):t._e()],1)};n._withStripped=!0;var s=a(59),o=a(69),l=a(68),i=function(){var a=this,e=a.$createElement,n=a._self._c||e;return n("section",{staticClass:"addContent"},[n("el-dialog",{attrs:{title:"添加内容",width:"1000px",visible:a.dialogVisible},on:{"update:visible":function(e){a.dialogVisible=e},close:a.handleClose}},[n("div",{staticClass:"add-from"},[n("el-input",{staticClass:"content-input",attrs:{placeholder:"内容名称/内容ID"},model:{value:a.tableParams.courseNameLike,callback:function(e){a.$set(a.tableParams,"courseNameLike",e)},expression:"tableParams.courseNameLike"}}),a._v(" "),n("span",{staticClass:"search-button",on:{click:a.searchSub}},[a._v("查询")])],1),a._v(" "),n("div",{staticClass:"select-content"},[n("div",{staticClass:"choosed-text"},[a.currentProduct.courseName?n("span",[a._v('已选"'+a._s(a.currentProduct.courseName)+'"')]):a._e()]),a._v(" "),n("div",{staticClass:"search-button",on:{click:a.addContent}},[a._v("添加内容")])]),a._v(" "),n("el-table",{ref:"multipleTable",staticStyle:{width:"90%","margin-left":"50px"},attrs:{data:a.proListDatas}},[n("el-table-column",{attrs:{prop:"nodeNum",label:"选择",width:"100"},scopedSlots:a._u([{key:"default",fn:function(t){return[n("el-radio",{attrs:{label:t.row.id},nativeOn:{change:function(e){a.getRadioRow(t.row)}},model:{value:a.templateRadio,callback:function(e){a.templateRadio=e},expression:"templateRadio"}},[a._v(" \n          ")])]}}])}),a._v(" "),n("el-table-column",{attrs:{prop:"courseName",label:"内容名称"}}),a._v(" "),n("el-table-column",{attrs:{label:"视频数",formatter:a.fromTotalNum}})],1),a._v(" "),10<a.total?n("el-pagination",{staticStyle:{"text-align":"center",margin:"20px 0 20px"},attrs:{"current-page":a.currentPage,"page-sizes":[10,20,30,50,100],"page-size":a.pageSize,layout:"total, prev, pager, next, jumper, sizes",total:a.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}}):a._e()],1)],1)};i._withStripped=!0;var r={data:function(){return{tableParams:{firstResult:0,maxResult:10,courseNameLike:""},dialogVisible:!0,axiosNum:0,currentProduct:{},proListDatas:[],currentPage:1,pageSize:10,total:0,templateRadio:""}},methods:{fromTotalNum:function(e){return e.totalNum+" 讲"},addContent:function(){this.currentProduct.courseName&&this.$emit("addContent",this.currentProduct)},handleClose:function(e){this.$emit("closeDalog",!1)},searchSub:function(){this.tableParams.firstResult=0,this.addPointFn()},addPointFn:function(){var t=this,e={firstResult:this.tableParams.firstResult,maxResult:this.tableParams.maxResult,courseNameLike:this.tableParams.courseNameLike};Object(s.a)({method:o.a.getCoursesList.type,url:o.a.getCoursesList.url,params:e}).then(function(e){l.default.closeLoading(),t.proListDatas=[],t.total=0,e&&e.data&&e.data.responseObject&&e.data.responseObject.responseData&&e.data.responseObject.responseStatus?e.data.responseObject.responseData.dataList&&0<e.data.responseObject.responseData.dataList.length&&(t.proListDatas=e.data.responseObject.responseData.dataList,t.total=e.data.responseObject.responseData.totalCount):t.$message.error("数据获取失败，请重试！")}).catch(function(e){l.default.closeLoading(),t.$allin_confirm({title:"提示",content:tipMsg||"获取失败，请刷新重试",type:"notice"})})},getRadioRow:function(e){this.currentProduct=e},handleSizeChange:function(e){this.pageSize=e,this.tableParams.maxResult=this.pageSize,this.tableParams.firstResult=0,this.currentPage=0,this.addPointFn()},handleCurrentChange:function(e){this.currentPage=e,this.tableParams.firstResult=(this.currentPage-1)*this.pageSize,this.addPointFn()},getListAxios:function(e,t,a,n,i,o){var r=this;l.default.openLoading("加载中..."),this.axiosNum++,"post"===i&&Object(s.a)({method:"post",url:e,data:t}).then(function(e){r.axiosNum--,a&&a(e),r.axiosNum<=0&&l.default.closeLoading()}).catch(function(e){o&&o(),r.axiosNum--,r.axiosNum<=0&&l.default.closeLoading(),r.$allin_confirm({title:"提示",content:n||"获取失败，请刷新重试",type:"notice"})})}},mounted:function(){this.addPointFn()}},c=(a(865),a(58)),d=Object(c.a)(r,i,[],!1,null,null,null);d.options.__file="src/views/redeemCode/components/AddContent.vue";var p={data:function(){var a=this;return{isDisabled:!1,form:{redeemCodeName:"",publishCount:"",publishType:"0",date1:[new Date,new Date("")],usageCount:1,productList:"",productPrice:"",total:"",applyDepartment:"",applyUser:"",applyPurpose:"",applyNote:""},createTime:"",isSubmit:!1,rules:{redeemCodeName:[{required:!0,message:"请输入兑换码名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],publishCount:[{required:!0,message:"请输入发行量",trigger:"blur"}],publishType:[{required:!0,message:"请选择发行类型",trigger:"change"}],date1:[{required:!0,validator:function(e,t,a){return t?"Invalid Date"===t[1].toString()?a(new Error("请选择日期")):void a():a(new Error("请选择日期"))},trigger:"change"}],productList:[{required:!0,message:"请添加内容",trigger:"blur"}],productPrice:[{required:!0,message:"请输入商品价值",trigger:"blur"}],total:[{required:!0,message:"请输入总额",trigger:"blur"}],applyDepartment:[{required:!0,message:"请选择申请部门",trigger:"change"}],applyUser:[{required:!0,message:"请输入申请人",trigger:"blur"}],applyPurpose:[{required:!0,message:"请选择活动资源",trigger:"change"}]},showAdd:!1,redeemCodeId:"",pickerOptions:{disabledDate:function(e){var t=a.dateChange(new Date)+" 00:00:00";return e.getTime()<new Date(t).getTime()}},defaultValue:this.dateChange(new Date)}},components:{addContent:d.exports},methods:{dateChange:function(e){var t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return a<10&&(a="0"+a),n<10&&(n="0"+n),t+"-"+a+"-"+n},inputBlur:function(e){this.form[e]&&(this.form[e]=parseInt(this.form[e],10))},onSubmit:function(){var t=this;t.$refs.form.validate(function(e){if(!e)return!1;t.isSubmit||(t.isSubmit=!0,t.submitTip())})},closeContent:function(){this.form.productList="",this.form.productPrice="",this.form.total=""},contentAdd:function(e){this.showAdd=!1;var t=e.collegeCourseAttachmentVOList&&e.collegeCourseAttachmentVOList.length&&e.collegeCourseAttachmentVOList[0].attUrl;this.form.productList=[{productId:e.id,productName:e.courseName,picUrl:t,productPrice:e.coursePriceElement}],this.form.productPrice=e.coursePriceElement,this.form.publishCount.toString()&&(this.form.total=(this.form.productPrice*this.form.publishCount).toFixed(2))},closeDalog:function(){this.showAdd=!1},limmitLength:function(){var e=this;e.$nextTick(function(){e.form.redeemCodeName&&20<e.form.redeemCodeName.length&&(e.form.redeemCodeName=e.form.redeemCodeName.substr(0,20))})},limmitNumber:function(e,t,a){var n=this;n.$nextTick(function(){null!==n.form[e]&&""!==n.form[e]&&(n.form[e]=n.form[e].replace(/[^\d]/g,""),t&&n.form[e]>t&&(n.form[e]=t),t&&n.form[e]<a&&(n.form[e]=a))}),"publishCount"===e&&n.form.productPrice.toString()&&(n.form.total=(n.form.productPrice*n.form.publishCount).toFixed(2))},getCodeDetail:function(){var t=this,n=this;l.default.openLoading("加载中..."),Object(s.a)({method:o.a.getRedeemCodeById.type,url:o.a.getRedeemCodeById.url,params:{redeemCodeId:n.redeemCodeId}}).then(function(e){if(l.default.closeLoading(),e&&e.data&&e.data.responseObject&&e.data.responseObject.responseData&&e.data.responseObject.responseData.dataList){var t=e.data.responseObject.responseData.dataList[0];for(var a in n.form)if("productPrice"!==a&&""!==t[a])switch(a){case"publishType":case"applyDepartment":case"applyPurpose":n.form[a]=t[a].toString();break;case"productList":t[a]&&t[a].length&&(n.form[a]=t[a],n.form.productPrice=t[a][0].productPrice);break;case"date1":n.form[a]=[new Date(t.startTime),new Date(t.endTime)];break;default:n.form[a]=t[a]}}}).catch(function(e){l.default.closeLoading(),t.$allin_confirm({title:"提示",content:"查询失败",type:"notice"})})},submitTip:function(){var e=this;e.$confirm("兑换码生成后，主要字段信息不得修改，是否确认生成？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){e.createCodeApi()}).catch(function(){})},createCodeApi:function(){var t=this,a=this;l.default.openLoading("加载中...");var e={};if(a.redeemCodeId)e={redeemCodeId:a.redeemCodeId,redeemCodeName:a.form.redeemCodeName};else{var n=localStorage.getItem("userLoginName");for(var i in n&&(e.opUser=n),a.form)if("productPrice"!==i&&"total"!==i)switch(i){case"publishType":case"applyDepartment":case"applyPurpose":e[i]=parseInt(a.form[i],10);break;case"date1":e.startTime=a.form[i][0],e.endTime=a.form[i][1];break;case"productList":e.productList=[{productId:a.form.productList[0].productId,productPrice:100*parseInt(a.form.productPrice,10)}];break;default:e[i]=a.form[i]}}Object(s.a)({method:o.a.createRedeemCode.type,url:o.a.createRedeemCode.url,data:e}).then(function(e){l.default.closeLoading(),e&&e.data&&e.data.responseObject&&e.data.responseObject.responseStatus?a.$message({type:"success",message:"创建成功",onClose:function(){a.$router.push({path:"/codeBatch"})}}):(a.isSubmit=!1,t.$allin_confirm({title:"提示",content:"创建兑换码失败",type:"notice"}))}).catch(function(e){l.default.closeLoading(),a.isSubmit=!1,t.$allin_confirm({title:"提示",content:"创建兑换码失败",type:"notice"})})}},created:function(){window.onbeforeunload=function(){return"离开此网站，系统可能不会保存您所做的更改。"},this.$route.query.redeemCodeId&&(this.isDisabled=!0,this.redeemCodeId=this.$route.query.redeemCodeId)},mounted:function(){this.redeemCodeId&&this.getCodeDetail()},destroyed:function(){document.onkeydown=null,window.onbeforeunload=null,l.default.goBack()},watch:{}},u=(a(867),Object(c.a)(p,n,[function(){var e=this.$createElement,t=this._self._c||e;return t("section",{staticClass:"code-tip"},[t("p",[this._v("创建成功后，只能修改兑换码名称")])])}],!1,null,null,null));u.options.__file="src/views/redeemCode/createCode.vue";t.default=u.exports}}]);